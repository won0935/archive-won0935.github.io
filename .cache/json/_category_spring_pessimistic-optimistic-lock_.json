{"data":{"site":{"siteMetadata":{"title":"Jay ê¸°ìˆ  ë¸”ë¡œê·¸","author":"won0935","siteUrl":"https://won0935.github.io"}},"markdownRemark":{"id":"51da725f-f9b9-5ada-87b4-da53008caccf","excerpt":"ìš”ì•½ Redis ê°€ DBë½ë³´ë‹¤ ì„±ëŠ¥ì´ ì¢‹ìŒ pub-sub ë°©ì‹ì¸  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìì£¼ ì‚¬ìš©í•˜ëŠ” ì¶”ì„¸ì„ ë‹¨, Redis ìš´ì˜ë¹„ìš©ì´ ë”°ë¡œ ë°œìƒë˜ëŠ” ë‹¨ì ì´ ìˆìŒ ë™ì‹œì„± ì´ìŠˆë¥¼ í•´ê²°í•˜ëŠ” ë°©ë²• ì†ŒìŠ¤ì½”ë“œ  ëª…ë ¹ì–´ ë°ì´í„°ë² ì´ìŠ¤ Pessimistic Lock(ë¹„ê´€ì  ë½) Optimisitic Lockâ€¦","html":"<h1 id=\"ìš”ì•½\" style=\"position:relative;\"><a href=\"#%EC%9A%94%EC%95%BD\" aria-label=\"ìš”ì•½ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ìš”ì•½</h1>\n<ul>\n<li><strong>Redis</strong> ê°€ <strong>DBë½</strong>ë³´ë‹¤ ì„±ëŠ¥ì´ ì¢‹ìŒ</li>\n<li><strong>pub-sub</strong> ë°©ì‹ì¸ <code class=\"language-text\">Redisson</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìì£¼ ì‚¬ìš©í•˜ëŠ” ì¶”ì„¸ì„</li>\n<li>ë‹¨, Redis ìš´ì˜ë¹„ìš©ì´ ë”°ë¡œ ë°œìƒë˜ëŠ” ë‹¨ì ì´ ìˆìŒ</li>\n</ul>\n<h2 id=\"ë™ì‹œì„±-ì´ìŠˆë¥¼-í•´ê²°í•˜ëŠ”-ë°©ë²•\" style=\"position:relative;\"><a href=\"#%EB%8F%99%EC%8B%9C%EC%84%B1-%EC%9D%B4%EC%8A%88%EB%A5%BC-%ED%95%B4%EA%B2%B0%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95\" aria-label=\"ë™ì‹œì„± ì´ìŠˆë¥¼ í•´ê²°í•˜ëŠ” ë°©ë²• permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë™ì‹œì„± ì´ìŠˆë¥¼ í•´ê²°í•˜ëŠ” ë°©ë²•</h2>\n<ol>\n<li>\n<p><strong>ì†ŒìŠ¤ì½”ë“œ</strong></p>\n<ul>\n<li><code class=\"language-text\">syncronized</code> ëª…ë ¹ì–´</li>\n</ul>\n</li>\n<li>\n<p><strong>ë°ì´í„°ë² ì´ìŠ¤</strong></p>\n<ul>\n<li>Pessimistic Lock(ë¹„ê´€ì  ë½)</li>\n<li>Optimisitic Lock(ë‚™ê´€ì  ë½)</li>\n</ul>\n</li>\n<li>\n<p><strong>ë ˆë””ìŠ¤(Redis)</strong></p>\n<ul>\n<li><code class=\"language-text\">Lettuce</code></li>\n<li><code class=\"language-text\">Redisson</code></li>\n</ul>\n</li>\n</ol>\n<hr>\n<h1 id=\"ì†ŒìŠ¤ì½”ë“œ-ì—ì„œ-ë™ì‹œì„±-ì´ìŠˆ-í•´ê²°\" style=\"position:relative;\"><a href=\"#%EC%86%8C%EC%8A%A4%EC%BD%94%EB%93%9C-%EC%97%90%EC%84%9C-%EB%8F%99%EC%8B%9C%EC%84%B1-%EC%9D%B4%EC%8A%88-%ED%95%B4%EA%B2%B0\" aria-label=\"ì†ŒìŠ¤ì½”ë“œ ì—ì„œ ë™ì‹œì„± ì´ìŠˆ í•´ê²° permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>ì†ŒìŠ¤ì½”ë“œ</strong> ì—ì„œ ë™ì‹œì„± ì´ìŠˆ í•´ê²°</h1>\n<h2 id=\"syncronized-ì‚¬ìš©\" style=\"position:relative;\"><a href=\"#syncronized-%EC%82%AC%EC%9A%A9\" aria-label=\"syncronized ì‚¬ìš© permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">syncronized</code> ì‚¬ìš©</h2>\n<h4 id=\"ì½”ë“œ\" style=\"position:relative;\"><a href=\"#%EC%BD%94%EB%93%9C\" aria-label=\"ì½”ë“œ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì½”ë“œ</h4>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-kotlin line-numbers\"><code class=\"language-kotlin\"> <span class=\"token keyword\">fun</span> <span class=\"token function\">decrease</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> Long<span class=\"token punctuation\">,</span> quantity<span class=\"token operator\">:</span> Long<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">synchronized</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">//ìŠ¤ë ˆë“œë¥¼ í•˜ë‚˜ë§Œ ì‚¬ìš©</span>\n        <span class=\"token keyword\">val</span> stock <span class=\"token operator\">=</span> stockRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findByIdOrNull</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span> <span class=\"token operator\">?:</span> <span class=\"token keyword\">throw</span> <span class=\"token function\">EntityNotFoundException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        stock<span class=\"token punctuation\">.</span><span class=\"token function\">decrease</span><span class=\"token punctuation\">(</span>quantity<span class=\"token punctuation\">)</span>\n        stockRepository<span class=\"token punctuation\">.</span><span class=\"token function\">saveAndFlush</span><span class=\"token punctuation\">(</span>stock<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"ë¬¸ì œì \" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C%EC%A0%90\" aria-label=\"ë¬¸ì œì  permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë¬¸ì œì </h4>\n<p>ì„œë²„ê°€ 1ëŒ€ì¼ ë•ŒëŠ” ë˜ëŠ”ë“¯ ì‹¶ìœ¼ë‚˜ <strong>ì—¬ëŸ¬ëŒ€ì˜ ì„œë²„</strong>ë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ì„ ë•Œì™€ ë™ì¼í•œ <strong>ë¬¸ì œ</strong>ê°€ ë°œìƒëœë‹¤. ì¸ìŠ¤í„´ìŠ¤ ë‹¨ìœ„ë¡œ thread-safe ì´ ë³´ì¥ì´ ë˜ê³ , ì—¬ëŸ¬ ì„œë²„ê°€ ëœë‹¤ë©´ ì—¬ëŸ¬ê°œì˜\nì¸ìŠ¤í„´ìŠ¤ê°€ ìˆëŠ” ê²ƒê³¼ ë™ì¼í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ìœ„ ì´ìœ ë¡œ <strong>ì‹¤ë¬´ì—ì„œëŠ” ì‚¬ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤</strong>.</p>\n<hr>\n<h1 id=\"ë°ì´í„°ë² ì´ìŠ¤-ì—ì„œ-ë™ì‹œì„±-ì´ìŠˆ-í•´ê²°\" style=\"position:relative;\"><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%97%90%EC%84%9C-%EB%8F%99%EC%8B%9C%EC%84%B1-%EC%9D%B4%EC%8A%88-%ED%95%B4%EA%B2%B0\" aria-label=\"ë°ì´í„°ë² ì´ìŠ¤ ì—ì„œ ë™ì‹œì„± ì´ìŠˆ í•´ê²° permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>ë°ì´í„°ë² ì´ìŠ¤</strong> ì—ì„œ ë™ì‹œì„± ì´ìŠˆ í•´ê²°</h1>\n<h2 id=\"pessimistic-lockë¹„ê´€ì -ë½\" style=\"position:relative;\"><a href=\"#pessimistic-lock%EB%B9%84%EA%B4%80%EC%A0%81-%EB%9D%BD\" aria-label=\"pessimistic lockë¹„ê´€ì  ë½ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Pessimistic Lock(ë¹„ê´€ì  ë½)</h2>\n<h4 id=\"ì½”ë“œ-1\" style=\"position:relative;\"><a href=\"#%EC%BD%94%EB%93%9C-1\" aria-label=\"ì½”ë“œ 1 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì½”ë“œ</h4>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-kotlin line-numbers\"><code class=\"language-kotlin\"> <span class=\"token annotation builtin\">@Lock</span><span class=\"token punctuation\">(</span>LockModeType<span class=\"token punctuation\">.</span>PESSIMISTIC_WRITE<span class=\"token punctuation\">)</span> <span class=\"token comment\">//ë¹„ê´€ë½ ì‚¬ìš©</span>\n<span class=\"token annotation builtin\">@Query</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"select s from Stock s where s.id = :id\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">fun</span> <span class=\"token function\">findByIdWithPessimisticLock</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> Long<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Stock</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"ì„¤ëª…\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EB%AA%85\" aria-label=\"ì„¤ëª… permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì„¤ëª…</h4>\n<ul>\n<li><strong>ì„ ì  ì ê¸ˆ</strong>ì´ë¼ê³  ë¶ˆë¦¬ê¸°ë„ í•¨</li>\n<li>íŠ¸ëœì­ì…˜ë¼ë¦¬ì˜ <strong>ì¶©ëŒì´ ë°œìƒí•œë‹¤ê³  ê°€ì •</strong>í•˜ê³  ìš°ì„  ë½ì„ ê±°ëŠ” ë°©ë²•</li>\n<li><strong>DBì—ì„œ ì œê³µí•˜ëŠ” ë½ê¸°ëŠ¥</strong>ì„ ì‚¬ìš©</li>\n</ul>\n<h4 id=\"lockmodetype-ì˜µì…˜\" style=\"position:relative;\"><a href=\"#lockmodetype-%EC%98%B5%EC%85%98\" aria-label=\"lockmodetype ì˜µì…˜ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">LockModeType</code> ì˜µì…˜</h4>\n<ul>\n<li>\n<p><code class=\"language-text\">PESSIMISTIC_WRITE</code></p>\n<ul>\n<li>ì¼ë°˜ì ì¸ ì˜µì…˜. ë°ì´í„°ë² ì´ìŠ¤ì— ì“°ê¸° ë½</li>\n<li>ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ <strong>ì½ê¸°ë„ ì“°ê¸°ë„ ëª»í•¨</strong> (ë°°íƒ€ì  ì ê¸ˆ), </li>\n<li><code class=\"language-text\">SELECT FOR ~ UPDATE</code> ë¡œ ì¿¼ë¦¬ê°€ ë‚˜ê°</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">PESSIMISTIC_READ</code></p>\n<ul>\n<li>ë°˜ë³µ ì½ê¸°ë§Œí•˜ê³  ìˆ˜ì •í•˜ì§€ ì•ŠëŠ” ìš©ë„ë¡œ ë½ì„ ê±¸ ë•Œ ì‚¬ìš©</li>\n<li>ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ <strong>ì½ê¸°ëŠ” ê°€ëŠ¥í•¨</strong> (ê³µìœ  ì ê¸ˆ)</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"optimisitic-lockë‚™ê´€ì -ë½\" style=\"position:relative;\"><a href=\"#optimisitic-lock%EB%82%99%EA%B4%80%EC%A0%81-%EB%9D%BD\" aria-label=\"optimisitic lockë‚™ê´€ì  ë½ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Optimisitic Lock(ë‚™ê´€ì  ë½)</h2>\n<h4 id=\"ì½”ë“œ-2\" style=\"position:relative;\"><a href=\"#%EC%BD%94%EB%93%9C-2\" aria-label=\"ì½”ë“œ 2 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì½”ë“œ</h4>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-kotlin line-numbers\"><code class=\"language-kotlin\"><span class=\"token annotation builtin\">@Lock</span><span class=\"token punctuation\">(</span>LockModeType<span class=\"token punctuation\">.</span>OPTIMISTIC<span class=\"token punctuation\">)</span> <span class=\"token comment\">// ë‚™ê´€ë½ ì‚¬ìš©</span>\n<span class=\"token annotation builtin\">@Query</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"select s from Stock s where s.id = :id\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">fun</span> <span class=\"token function\">findByIdWithOptimisticLock</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> Long<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Stock</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-kotlin line-numbers\"><code class=\"language-kotlin\"><span class=\"token annotation builtin\">@Entity</span>\n<span class=\"token keyword\">class</span> <span class=\"token function\">Stock</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">val</span> id<span class=\"token operator\">:</span> Long <span class=\"token operator\">=</span> <span class=\"token number\">0L</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">/* ìƒëµ */</span>\n\n    <span class=\"token annotation builtin\">@Version</span> <span class=\"token comment\">//ê¸ì •ë½</span>\n    <span class=\"token keyword\">val</span> version<span class=\"token operator\">:</span> Long <span class=\"token operator\">=</span> <span class=\"token number\">0L</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span> </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"ì„¤ëª…-1\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EB%AA%85-1\" aria-label=\"ì„¤ëª… 1 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì„¤ëª…</h4>\n<ul>\n<li>ë°ì´í„° ê°±ì‹  ì‹œ <strong>ì¶©ëŒì´ ë°œìƒí•˜ì§€ ì•Šì„ ê²ƒì´ë¼ê³  ê°€ì •</strong>í•¨</li>\n<li>ë°ì´í„° ìˆ˜ì •ì— ëŒ€í•´ ì¶©ëŒì´ ë‚¬ì„ ê²½ìš° í›„ì— ì—…ë°ì´íŠ¸ í•œ ì‚¬ëŒì˜ <strong>ë³€ê²½ ì‚¬í•­ì€ ë¬´ì‹œ</strong>ë¨</li>\n<li>ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ í•´ë‹¹ ë°ì´í„°ë¥¼ ë³€ê²½í•˜ì§€ ì•Šì„ ê²½ìš° ë³€ê²½</li>\n</ul>\n<h3 id=\"ì£¼ì˜ì‚¬í•­\" style=\"position:relative;\"><a href=\"#%EC%A3%BC%EC%9D%98%EC%82%AC%ED%95%AD\" aria-label=\"ì£¼ì˜ì‚¬í•­ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì£¼ì˜ì‚¬í•­</h3>\n<ul>\n<li>ë‚™ê´€ë½ ìœ„ë°° ì‹œ <code class=\"language-text\">OptimisticLockException</code> ë°œìƒ</li>\n<li><strong>ë³„ë„ì˜ ì²˜ë¦¬</strong>ê°€ í•„ìš”í•¨</li>\n</ul>\n<hr>\n<h1 id=\"ë ˆë””ìŠ¤redis-ì—ì„œ-ë™ì‹œì„±-ì´ìŠˆ-í•´ê²°\" style=\"position:relative;\"><a href=\"#%EB%A0%88%EB%94%94%EC%8A%A4redis-%EC%97%90%EC%84%9C-%EB%8F%99%EC%8B%9C%EC%84%B1-%EC%9D%B4%EC%8A%88-%ED%95%B4%EA%B2%B0\" aria-label=\"ë ˆë””ìŠ¤redis ì—ì„œ ë™ì‹œì„± ì´ìŠˆ í•´ê²° permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>ë ˆë””ìŠ¤(Redis)</strong> ì—ì„œ ë™ì‹œì„± ì´ìŠˆ í•´ê²°</h1>\n<h2 id=\"lettuce\" style=\"position:relative;\"><a href=\"#lettuce\" aria-label=\"lettuce permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lettuce</h2>\n<ul>\n<li><code class=\"language-text\">setnx</code> ëª…ë ¹ì–´ë¥¼ í™œìš©í•´ ë¶„ì‚°ë½ êµ¬í˜„</li>\n<li><strong>ìŠ¤í•€ë½</strong> ë°©ì‹ </li>\n</ul>\n<h4 id=\"ì½”ë“œ-3\" style=\"position:relative;\"><a href=\"#%EC%BD%94%EB%93%9C-3\" aria-label=\"ì½”ë“œ 3 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì½”ë“œ</h4>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-kotlin line-numbers\"><code class=\"language-kotlin\"><span class=\"token annotation builtin\">@Component</span>\n<span class=\"token keyword\">class</span> <span class=\"token function\">RedisLockRepository</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">val</span> redisTemplate<span class=\"token operator\">:</span> RedisTemplate<span class=\"token operator\">&lt;</span>String<span class=\"token punctuation\">,</span> String<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">fun</span> <span class=\"token function\">lock</span><span class=\"token punctuation\">(</span>key<span class=\"token operator\">:</span> Long<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Boolean <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> redisTemplate\n            <span class=\"token punctuation\">.</span><span class=\"token function\">opsForValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">setIfAbsent</span><span class=\"token punctuation\">(</span><span class=\"token function\">generateKey</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lock\"</span><span class=\"token punctuation\">,</span> Duration<span class=\"token punctuation\">.</span><span class=\"token function\">ofMillis</span><span class=\"token punctuation\">(</span><span class=\"token number\">3_000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">?:</span> <span class=\"token keyword\">throw</span> <span class=\"token function\">RedisException</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">fun</span> <span class=\"token function\">unlock</span><span class=\"token punctuation\">(</span>key<span class=\"token operator\">:</span> Long<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        redisTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token function\">generateKey</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">fun</span> <span class=\"token function\">generateKey</span><span class=\"token punctuation\">(</span>key<span class=\"token operator\">:</span> Long<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> String <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> key<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-kotlin line-numbers\"><code class=\"language-kotlin\"><span class=\"token annotation builtin\">@Component</span>\n<span class=\"token keyword\">class</span> <span class=\"token function\">LettuceLockStockFacade</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">val</span> redisLockRepository<span class=\"token operator\">:</span> RedisLockRepository<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">val</span> stockService<span class=\"token operator\">:</span> StockService\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation builtin\">@Transactional</span>\n    <span class=\"token keyword\">fun</span> <span class=\"token function\">decrease</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> Long<span class=\"token punctuation\">,</span> quantity<span class=\"token operator\">:</span> Long<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>redisLockRepository<span class=\"token punctuation\">.</span><span class=\"token function\">lock</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            Thread<span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\">//ë½ì¡ìŒ</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            stockService<span class=\"token punctuation\">.</span><span class=\"token function\">decrease</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> quantity<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n            redisLockRepository<span class=\"token punctuation\">.</span><span class=\"token function\">unlock</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span> <span class=\"token comment\">//ë½í’ˆ</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"redisson\" style=\"position:relative;\"><a href=\"#redisson\" aria-label=\"redisson permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Redisson</h2>\n<ul>\n<li><code class=\"language-text\">pub-sub</code> ê¸°ë°˜ìœ¼ë¡œ ë¶„ì‚°ë½ êµ¬í˜„</li>\n</ul>\n<h4 id=\"ì½”ë“œ-4\" style=\"position:relative;\"><a href=\"#%EC%BD%94%EB%93%9C-4\" aria-label=\"ì½”ë“œ 4 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì½”ë“œ</h4>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-kotlin line-numbers\"><code class=\"language-kotlin\"><span class=\"token function\">implementation</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"org.redisson:redisson:3.19.0\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">//redisson ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-kotlin line-numbers\"><code class=\"language-kotlin\"><span class=\"token annotation builtin\">@Component</span>\n<span class=\"token keyword\">class</span> <span class=\"token function\">RedissonLockStockFacade</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">val</span> redissonClient<span class=\"token operator\">:</span> RedissonClient<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">val</span> stockService<span class=\"token operator\">:</span> StockService\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">fun</span> <span class=\"token function\">decrease</span><span class=\"token punctuation\">(</span>id <span class=\"token operator\">:</span> Long<span class=\"token punctuation\">,</span> quantity<span class=\"token operator\">:</span> Long<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">val</span> lock <span class=\"token operator\">=</span> redissonClient<span class=\"token punctuation\">.</span><span class=\"token function\">getLock</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">//ë½ì¡ìŒ</span>\n\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">val</span> available <span class=\"token operator\">=</span> lock<span class=\"token punctuation\">.</span><span class=\"token function\">tryLock</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> TimeUnit<span class=\"token punctuation\">.</span>SECONDS<span class=\"token punctuation\">)</span>\n\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>available<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n                <span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ë½ íšë“ ì‹¤íŒ¨\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">return</span>\n            <span class=\"token punctuation\">}</span>\n\n            stockService<span class=\"token punctuation\">.</span><span class=\"token function\">decrease</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> quantity<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e <span class=\"token operator\">:</span> InterruptedException<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> <span class=\"token function\">RuntimeException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n            lock<span class=\"token punctuation\">.</span><span class=\"token function\">unlock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">//ë½í’ˆ</span>\n        <span class=\"token punctuation\">}</span>\n\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"ì¥ë‹¨ì \" style=\"position:relative;\"><a href=\"#%EC%9E%A5%EB%8B%A8%EC%A0%90\" aria-label=\"ì¥ë‹¨ì  permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì¥ë‹¨ì </h2>\n<ul>\n<li>\n<p><code class=\"language-text\">Lettuce</code></p>\n<ul>\n<li>êµ¬í˜„ì´ ê°„ë‹¨í•˜ë‹¤</li>\n<li><code class=\"language-text\">spring data redis</code> ë¥¼ ì´ìš©í•˜ë©´ lettuce ê°€ ê¸°ë³¸ì´ê¸° ë•Œë¬¸ì— <strong>ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„</strong> ëœë‹¤</li>\n<li><strong>spin lock ë°©ì‹</strong>ì´ê¸°ë•Œë¬¸ì— ë™ì‹œì— ë§ì€ ìŠ¤ë ˆë“œê°€ lock íšë“ ëŒ€ê¸° ìƒíƒœë¼ë©´ <strong>redis ì— ë¶€í•˜</strong>ê°€ ê°ˆ ìˆ˜ ìˆë‹¤</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">Redisson</code></p>\n<ul>\n<li>ë½ íšë“ <strong>ì¬ì‹œë„</strong>ë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•œë‹¤</li>\n<li><strong>pub-sub ë°©ì‹</strong>ìœ¼ë¡œ êµ¬í˜„ì´ ë˜ì–´ìˆê¸° ë•Œë¬¸ì— lettuce ì™€ ë¹„êµí–ˆì„ ë•Œ redis ì— ë¶€í•˜ê°€ ëœ ê°„ë‹¤</li>\n<li><strong>ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬</strong>ë¥¼ ì‚¬ìš©í•´ì•¼í•œë‹¤</li>\n<li>lock ì„ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì°¨ì›ì—ì„œ ì œê³µí•´ì£¼ê¸° ë–„ë¬¸ì— ì‚¬ìš©ë²•ì„ ê³µë¶€í•´ì•¼ í•œë‹¤</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"ì‹¤ë¬´ì—ì„œëŠ”-\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%EB%AC%B4%EC%97%90%EC%84%9C%EB%8A%94-\" aria-label=\"ì‹¤ë¬´ì—ì„œëŠ”  permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì‹¤ë¬´ì—ì„œëŠ” ?</h2>\n<ul>\n<li>ì¬ì‹œë„ê°€ í•„ìš”í•˜ì§€ <strong>ì•Šì€</strong> lock ì€ <code class=\"language-text\">Lettuce</code> í™œìš©</li>\n<li>ì¬ì‹œë„ê°€ <strong>í•„ìš”í•œ</strong> ê²½ìš°ì—ëŠ” <code class=\"language-text\">Redisson</code> ë¥¼ í™œìš©</li>\n</ul>","tableOfContents":"<ul>\n<li>\n<p><a href=\"/category/spring/pessimistic-optimistic-lock/#%EC%9A%94%EC%95%BD\">ìš”ì•½</a></p>\n<ul>\n<li><a href=\"/category/spring/pessimistic-optimistic-lock/#%EB%8F%99%EC%8B%9C%EC%84%B1-%EC%9D%B4%EC%8A%88%EB%A5%BC-%ED%95%B4%EA%B2%B0%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95\">ë™ì‹œì„± ì´ìŠˆë¥¼ í•´ê²°í•˜ëŠ” ë°©ë²•</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/pessimistic-optimistic-lock/#%EC%86%8C%EC%8A%A4%EC%BD%94%EB%93%9C-%EC%97%90%EC%84%9C-%EB%8F%99%EC%8B%9C%EC%84%B1-%EC%9D%B4%EC%8A%88-%ED%95%B4%EA%B2%B0\"><strong>ì†ŒìŠ¤ì½”ë“œ</strong> ì—ì„œ ë™ì‹œì„± ì´ìŠˆ í•´ê²°</a></p>\n<ul>\n<li>\n<p><a href=\"/category/spring/pessimistic-optimistic-lock/#syncronized-%EC%82%AC%EC%9A%A9\"><code class=\"language-text\">syncronized</code> ì‚¬ìš©</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/spring/pessimistic-optimistic-lock/#%EC%BD%94%EB%93%9C\">ì½”ë“œ</a></li>\n<li><a href=\"/category/spring/pessimistic-optimistic-lock/#%EB%AC%B8%EC%A0%9C%EC%A0%90\">ë¬¸ì œì </a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/pessimistic-optimistic-lock/#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%97%90%EC%84%9C-%EB%8F%99%EC%8B%9C%EC%84%B1-%EC%9D%B4%EC%8A%88-%ED%95%B4%EA%B2%B0\"><strong>ë°ì´í„°ë² ì´ìŠ¤</strong> ì—ì„œ ë™ì‹œì„± ì´ìŠˆ í•´ê²°</a></p>\n<ul>\n<li>\n<p><a href=\"/category/spring/pessimistic-optimistic-lock/#pessimistic-lock%EB%B9%84%EA%B4%80%EC%A0%81-%EB%9D%BD\">Pessimistic Lock(ë¹„ê´€ì  ë½)</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/spring/pessimistic-optimistic-lock/#%EC%BD%94%EB%93%9C-1\">ì½”ë“œ</a></li>\n<li><a href=\"/category/spring/pessimistic-optimistic-lock/#%EC%84%A4%EB%AA%85\">ì„¤ëª…</a></li>\n<li><a href=\"/category/spring/pessimistic-optimistic-lock/#lockmodetype-%EC%98%B5%EC%85%98\"><code class=\"language-text\">LockModeType</code> ì˜µì…˜</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/pessimistic-optimistic-lock/#optimisitic-lock%EB%82%99%EA%B4%80%EC%A0%81-%EB%9D%BD\">Optimisitic Lock(ë‚™ê´€ì  ë½)</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/spring/pessimistic-optimistic-lock/#%EC%BD%94%EB%93%9C-2\">ì½”ë“œ</a></li>\n<li><a href=\"/category/spring/pessimistic-optimistic-lock/#%EC%84%A4%EB%AA%85-1\">ì„¤ëª…</a></li>\n</ul>\n</li>\n<li><a href=\"/category/spring/pessimistic-optimistic-lock/#%EC%A3%BC%EC%9D%98%EC%82%AC%ED%95%AD\">ì£¼ì˜ì‚¬í•­</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/pessimistic-optimistic-lock/#%EB%A0%88%EB%94%94%EC%8A%A4redis-%EC%97%90%EC%84%9C-%EB%8F%99%EC%8B%9C%EC%84%B1-%EC%9D%B4%EC%8A%88-%ED%95%B4%EA%B2%B0\"><strong>ë ˆë””ìŠ¤(Redis)</strong> ì—ì„œ ë™ì‹œì„± ì´ìŠˆ í•´ê²°</a></p>\n<ul>\n<li>\n<p><a href=\"/category/spring/pessimistic-optimistic-lock/#lettuce\">Lettuce</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/spring/pessimistic-optimistic-lock/#%EC%BD%94%EB%93%9C-3\">ì½”ë“œ</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/pessimistic-optimistic-lock/#redisson\">Redisson</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/spring/pessimistic-optimistic-lock/#%EC%BD%94%EB%93%9C-4\">ì½”ë“œ</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"/category/spring/pessimistic-optimistic-lock/#%EC%9E%A5%EB%8B%A8%EC%A0%90\">ì¥ë‹¨ì </a></li>\n<li><a href=\"/category/spring/pessimistic-optimistic-lock/#%EC%8B%A4%EB%AC%B4%EC%97%90%EC%84%9C%EB%8A%94-\">ì‹¤ë¬´ì—ì„œëŠ” ?</a></li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"[Lock] ë™ì‹œì„±ì´ìŠˆì— ëŒ€í•œ í•´ê²° ë°©ë²•","description":"","date":"2023.01.03","emoji":"ğŸ”’","category":"spring"}}},"pageContext":{"slug":"/category/spring/pessimistic-optimistic-lock/","relatedPosts":[{"node":{"fields":{"slug":"/category/spring/jdk-dynamic-proxy-vs-cglib/"},"frontmatter":{"title":"[Spring] JDK Dynamic Proxy VS CGLIB","date":"2022.10.30","emoji":"ğŸª”","category":"spring"}}},{"node":{"fields":{"slug":"/category/spring/spring-bean-lifecycle/"},"frontmatter":{"title":"[Spring] Spring Bean Lifecycle","date":"2022.10.25","emoji":"ğŸ”‹","category":"spring"}}},{"node":{"fields":{"slug":"/category/spring/bean-post-processor/"},"frontmatter":{"title":"[Spring] BeanPostProcessor","date":"2022.10.20","emoji":"ğŸ›Ÿ","category":"spring"}}},{"node":{"fields":{"slug":"/category/spring/spring-configuration/"},"frontmatter":{"title":"[Spring] Spring Configuration","date":"2022.10.15","emoji":"ğŸ–ï¸","category":"spring"}}}]}}