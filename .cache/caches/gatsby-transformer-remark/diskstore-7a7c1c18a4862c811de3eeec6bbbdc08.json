{"expireTime":9007200896353682000,"key":"transformer-remark-markdown-html-ast-7205175e94326d1fc17fb0d28bf93a89-gatsby-remark-code-titlesgatsby-remark-embed-youtubegatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-custom-blocksgatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":{"type":"root","children":[{"type":"element","tagName":"h2","properties":{"id":"개요","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%EA%B0%9C%EC%9A%94","aria-label":"개요 permalink","class":"anchor-header before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"개요","position":{"start":{"line":2,"column":4,"offset":4},"end":{"line":2,"column":6,"offset":6}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":6,"offset":6}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">루비콘 2기</code>","position":{"start":{"line":4,"column":1,"offset":8},"end":{"line":4,"column":9,"offset":16}}},{"type":"text","value":" ‘Party-ing’ 프로젝트를 진행하던 도중 ","position":{"start":{"line":4,"column":9,"offset":16},"end":{"line":4,"column":36,"offset":43}}},{"type":"raw","value":"<code class=\"language-text\">1:N</code>","position":{"start":{"line":4,"column":36,"offset":43},"end":{"line":4,"column":41,"offset":48}}},{"type":"text","value":" 관계를 가지는 엔티티를 Save 할 때 2개의 테이블에 데이터는 잘 생성되었으나 Save 쿼리문 뿐 아니라 Update 쿼리문이 추가로 발생되는 이슈를 경험해서 해결 방법을 공유하고자 합니다.","position":{"start":{"line":4,"column":41,"offset":48},"end":{"line":4,"column":149,"offset":156}}}],"position":{"start":{"line":4,"column":1,"offset":8},"end":{"line":4,"column":149,"offset":156}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"현재-이슈-발생-상황","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%ED%98%84%EC%9E%AC-%EC%9D%B4%EC%8A%88-%EB%B0%9C%EC%83%9D-%EC%83%81%ED%99%A9","aria-label":"현재 이슈 발생 상황 permalink","class":"anchor-header before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"현재 이슈 발생 상황","position":{"start":{"line":6,"column":4,"offset":161},"end":{"line":6,"column":15,"offset":172}}}],"position":{"start":{"line":6,"column":1,"offset":158},"end":{"line":6,"column":15,"offset":172}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"엔티티 정보는 다음과 같습니다.","position":{"start":{"line":8,"column":1,"offset":174},"end":{"line":8,"column":18,"offset":191}}}],"position":{"start":{"line":8,"column":1,"offset":174},"end":{"line":8,"column":18,"offset":191}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Review 엔티티","position":{"start":{"line":10,"column":3,"offset":195},"end":{"line":10,"column":13,"offset":205}}}],"position":{"start":{"line":10,"column":1,"offset":193},"end":{"line":10,"column":15,"offset":207}}}],"position":{"start":{"line":10,"column":1,"offset":193},"end":{"line":10,"column":15,"offset":207}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"reviewer 유저가 target 유저에게 리뷰를 남겼다는 정보를 가지는 관계 엔티티","position":{"start":{"line":12,"column":3,"offset":211},"end":{"line":12,"column":51,"offset":259}}}],"position":{"start":{"line":12,"column":1,"offset":209},"end":{"line":12,"column":51,"offset":259}}},{"type":"text","value":"\n"}],"position":{"start":{"line":12,"column":1,"offset":209},"end":{"line":12,"column":51,"offset":259}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-code-title\">Java</div>"},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Review</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> reviewId<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@ManyToOne</span><span class=\"token punctuation\">(</span>fetch <span class=\"token operator\">=</span> <span class=\"token class-name\">FetchType</span><span class=\"token punctuation\">.</span>LAZY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"reviewerId\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">User</span> reviewer<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@ManyToOne</span><span class=\"token punctuation\">(</span>fetch <span class=\"token operator\">=</span> <span class=\"token class-name\">FetchType</span><span class=\"token punctuation\">.</span>LAZY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"targetId\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">User</span> target<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@OneToMany</span><span class=\"token punctuation\">(</span>cascade <span class=\"token operator\">=</span> <span class=\"token class-name\">CascadeType</span><span class=\"token punctuation\">.</span>ALL<span class=\"token punctuation\">,</span> orphanRemoval <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"reviewId\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Rating</span><span class=\"token punctuation\">></span></span> rating<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Review</span> <span class=\"token function\">of</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span> reviewer<span class=\"token punctuation\">,</span> <span class=\"token class-name\">User</span> target<span class=\"token punctuation\">,</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Rating</span><span class=\"token punctuation\">></span></span> rating<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Review</span><span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">reviewer</span><span class=\"token punctuation\">(</span>reviewer<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">target</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">rating</span><span class=\"token punctuation\">(</span>rating<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":14,"column":1,"offset":261},"end":{"line":40,"column":4,"offset":979}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Rating 엔티티","position":{"start":{"line":42,"column":3,"offset":983},"end":{"line":42,"column":13,"offset":993}}}],"position":{"start":{"line":42,"column":1,"offset":981},"end":{"line":42,"column":15,"offset":995}}}],"position":{"start":{"line":42,"column":1,"offset":981},"end":{"line":42,"column":15,"offset":995}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"하나의 리뷰 내용을 가지고 있는 엔티티","position":{"start":{"line":44,"column":3,"offset":999},"end":{"line":44,"column":24,"offset":1020}}}],"position":{"start":{"line":44,"column":1,"offset":997},"end":{"line":44,"column":24,"offset":1020}}},{"type":"text","value":"\n"}],"position":{"start":{"line":44,"column":1,"offset":997},"end":{"line":44,"column":24,"offset":1020}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-code-title\">Java</div>"},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Rating</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> ratingId<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> length <span class=\"token operator\">=</span> <span class=\"token number\">45</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@Enumerated</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">EnumType</span><span class=\"token punctuation\">.</span>STRING<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Content</span> content<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Rating</span> <span class=\"token function\">of</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Content</span> content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Rating</span><span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">content</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":46,"column":1,"offset":1022},"end":{"line":62,"column":4,"offset":1410}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"실행되는 서비스 코드","position":{"start":{"line":64,"column":3,"offset":1414},"end":{"line":64,"column":14,"offset":1425}}}],"position":{"start":{"line":64,"column":1,"offset":1412},"end":{"line":64,"column":16,"offset":1427}}}],"position":{"start":{"line":64,"column":1,"offset":1412},"end":{"line":64,"column":16,"offset":1427}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-code-title\">Java</div>"},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token comment\">/**\n* 특정 사용자에게 리뷰하기\n* @param reviewerId : 리뷰 하는 사용자 ID (현재 사용자)\n* @param targetId : 리뷰 할 사용자 ID\n* @param reviewDto : 리뷰 내용 DTO\n*/</span>\n<span class=\"token annotation punctuation\">@Transactional</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">review</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> reviewerId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span> targetId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ReviewRequest</span> reviewDto<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">User</span> reviewer <span class=\"token operator\">=</span> userRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>reviewerId<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UserNotFoundException</span><span class=\"token operator\">::</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">User</span> target <span class=\"token operator\">=</span> userRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>targetId<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UserNotFoundException</span><span class=\"token operator\">::</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Review</span><span class=\"token punctuation\">></span></span> optional <span class=\"token operator\">=</span> reviewQueryRepository<span class=\"token punctuation\">.</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span>reviewerId<span class=\"token punctuation\">,</span> targetId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>optional<span class=\"token punctuation\">.</span><span class=\"token function\">isPresent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ReviewDuplicatedException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Review</span> review <span class=\"token operator\">=</span> <span class=\"token class-name\">Review</span><span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span>reviewer<span class=\"token punctuation\">,</span> target<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Rating</span><span class=\"token punctuation\">></span></span> ratingList <span class=\"token operator\">=</span> reviewDto<span class=\"token punctuation\">.</span><span class=\"token function\">getRatingList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    ratingList<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>rating <span class=\"token operator\">-></span> review<span class=\"token punctuation\">.</span><span class=\"token function\">getRating</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>rating<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    reviewRepository<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>review<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":66,"column":1,"offset":1429},"end":{"line":90,"column":4,"offset":2275}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{"id":"실행-결과","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%EC%8B%A4%ED%96%89-%EA%B2%B0%EA%B3%BC","aria-label":"실행 결과 permalink","class":"anchor-header before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"실행 결과","position":{"start":{"line":92,"column":6,"offset":2282},"end":{"line":92,"column":11,"offset":2287}}}],"position":{"start":{"line":92,"column":1,"offset":2277},"end":{"line":92,"column":12,"offset":2288}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"API 콜을 보내서 위의 서비스 코드를 실행시키면 다음과 같은 쿼리문이 발생합니다.","position":{"start":{"line":94,"column":1,"offset":2290},"end":{"line":94,"column":47,"offset":2336}}}],"position":{"start":{"line":94,"column":1,"offset":2290},"end":{"line":94,"column":47,"offset":2336}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d653b8466fa6bebcebde2c55461eec3d/d9b5d/api-call.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.255319148936174%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABWklEQVQoz62S627CMAyF8y5bIWmbS3MtvWgDJgTv/0BndoAJaUPapP346rh2j08jixACDocDlmXBfr/Huq6VYRjQNA2klD+y3W6x2Wy+IcZxrGIcp2mqzPOMUgpCDHDOwVr7a8TpdMLxeKwiDJ/P53PlQqzLikziORcauquD7rCJO6XkGgWraq1hjEGMEdY7vMoG1lgYZ/GiGkSKu12C6hS89+Br4th1XXXFMeaMvu8huMD3xQWeEFOCJvFCjgrlQ/D4mEdc5oQpUp8bqju+Cv6ulBGm75Bsj5aEBTvjAkdLOBLmSRzdLXeDR6sUjO7RtW3t19pUE2zAUL9tJRT1CH5YS0WemMlRKiSukaYFaX2nd5STq0zntLzBp0zi/PEVKbfXc6vQEkJKVQVyHpBuxGiQx0C/HK95cpTHCuchaAT/SF/xhLjvVIX2qPKwY8/yZ3wJPlvgv/Lvgp9E+FSizPJAmgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"API 콜\"\n        title=\"API 콜\"\n        src=\"/static/d653b8466fa6bebcebde2c55461eec3d/1d69c/api-call.png\"\n        srcset=\"/static/d653b8466fa6bebcebde2c55461eec3d/4dcb9/api-call.png 188w,\n/static/d653b8466fa6bebcebde2c55461eec3d/5ff7e/api-call.png 375w,\n/static/d653b8466fa6bebcebde2c55461eec3d/1d69c/api-call.png 750w,\n/static/d653b8466fa6bebcebde2c55461eec3d/78797/api-call.png 1125w,\n/static/d653b8466fa6bebcebde2c55461eec3d/d9b5d/api-call.png 1224w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>","position":{"start":{"line":96,"column":1,"offset":2338},"end":{"line":96,"column":32,"offset":2369}}}],"position":{"start":{"line":96,"column":1,"offset":2338},"end":{"line":96,"column":32,"offset":2369}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f7cd821b8b49940c93bc482a933483ca/2cefc/issue.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.42553191489361%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABPUlEQVQoz1VR23aDMAzjjwpbKXcoJCFcBi0t69n//4hmZaWjDzmyFVuWE68oS4zjiKZpYK2FUgrGGHRd55C81trlvCNu+cZtPOu9OElgpGBrJNZ17S5LGXY6nRBFEdI0RSK1cRy7nMic8T73qqrCsixuwjzPGIbBHcZ0zAGbYw7s+/7NIeM3h1meOwGSFCDZtu1LbHOXS93miDG5LMvcIc+cG3lpkqIVESXNRVEgPB53a0VIditm0kTM838h3vFZwjD8W1mZFvd1hRFXvTht+TGyxiAfZST+miaHlutJTSRNiYjx7Sni+z4Oh8MLvUnVeEwj+nOFqzWYtJLT4NJqzEY7bhZu6Sy6skAtrqvjB4KnSBAEb8e7lRm+2Sz4sBqXqsCqa5dfzwXu6uy4pa6Ey/HTW6xlik9fBJ8ie+FfIIkXHm7wqUEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"issue\"\n        title=\"issue\"\n        src=\"/static/f7cd821b8b49940c93bc482a933483ca/1d69c/issue.png\"\n        srcset=\"/static/f7cd821b8b49940c93bc482a933483ca/4dcb9/issue.png 188w,\n/static/f7cd821b8b49940c93bc482a933483ca/5ff7e/issue.png 375w,\n/static/f7cd821b8b49940c93bc482a933483ca/1d69c/issue.png 750w,\n/static/f7cd821b8b49940c93bc482a933483ca/78797/issue.png 1125w,\n/static/f7cd821b8b49940c93bc482a933483ca/2cefc/issue.png 1400w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>","position":{"start":{"line":98,"column":1,"offset":2371},"end":{"line":98,"column":29,"offset":2399}}}],"position":{"start":{"line":98,"column":1,"offset":2371},"end":{"line":98,"column":29,"offset":2399}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"DB 테이블 정보를 보면 결과는 정상적으로 동작하는 것을 확인할 수 있습니다.","position":{"start":{"line":100,"column":1,"offset":2401},"end":{"line":100,"column":44,"offset":2444}}}],"position":{"start":{"line":100,"column":1,"offset":2401},"end":{"line":100,"column":44,"offset":2444}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c7bda0a1909fa38cb2e0d1848aaeb6e6/41870/result.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.51063829787234%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABoElEQVQoz5WS626jMBCF/ULLJQlpKAYSCMQGc8kNdVUle2vf/xHOjo2pkqrVbn988vgMc4R8huV1h7w7oaBT7Y9o+gNaOiekatEez9Q7oT0c0Z/OaEh/uvzE9c8rLr9fDFdieL6ANf0emqrpsKsbbKVC1fbYVQr5TqIkTVIvEzXyUtA3CiX1ClmjVMr0qrYzp9ZZlm1QCoFtUSKKYyTFWGdZjihJkJJJUe4QcQ7f9zGbzeBP+DOjvUEac10XjuNAn77nwXN17cDTNeHankcDkzbh+96dodaYGbA4zrdx+N3gV2BRkkLDkzV4ukYYcSyCgFgiWI7oe2C1xSKw/cDU8xu0xobrC87E8fkXhh+vqA6DCUfogCiUraggVINC6UdvoLq9CU1Q+hWFqWgr9Gbo5LXGakqq6XpInZ6siBqF0EbSmEhrHK8zQ0phpZscycbWlnU2aixcrcAp3YjHZnUOw3fEcWJ+f8UTcEo3DB/HN6L3dS239a3G3i40sHx4QPgYYT5fmOY0dLca/4DdxW4MHLsS9+vwXvvU8LMPP9L/x/QvjmOXaqU20jcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"DB 결과\"\n        title=\"DB 결과\"\n        src=\"/static/c7bda0a1909fa38cb2e0d1848aaeb6e6/1d69c/result.png\"\n        srcset=\"/static/c7bda0a1909fa38cb2e0d1848aaeb6e6/4dcb9/result.png 188w,\n/static/c7bda0a1909fa38cb2e0d1848aaeb6e6/5ff7e/result.png 375w,\n/static/c7bda0a1909fa38cb2e0d1848aaeb6e6/1d69c/result.png 750w,\n/static/c7bda0a1909fa38cb2e0d1848aaeb6e6/78797/result.png 1125w,\n/static/c7bda0a1909fa38cb2e0d1848aaeb6e6/aa440/result.png 1500w,\n/static/c7bda0a1909fa38cb2e0d1848aaeb6e6/41870/result.png 1788w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>","position":{"start":{"line":102,"column":1,"offset":2446},"end":{"line":102,"column":30,"offset":2475}}}],"position":{"start":{"line":102,"column":1,"offset":2446},"end":{"line":102,"column":30,"offset":2475}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Insert 쿼리 작업만으로 테이블을 생성할 수 있음에도 왜 Update 쿼리가 추가로 발생하는지 의아했습니다.","position":{"start":{"line":104,"column":1,"offset":2477},"end":{"line":104,"column":63,"offset":2539}}}],"position":{"start":{"line":104,"column":1,"offset":2477},"end":{"line":104,"column":63,"offset":2539}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그것도 Insert 쿼리와 Update 쿼리문의 개수도 각각 2개씩으로 동일했습니다.","position":{"start":{"line":106,"column":1,"offset":2541},"end":{"line":106,"column":48,"offset":2588}}}],"position":{"start":{"line":106,"column":1,"offset":2541},"end":{"line":106,"column":48,"offset":2588}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">'결과만 잘 동작하면 되지 않나?'</code>","position":{"start":{"line":108,"column":1,"offset":2590},"end":{"line":108,"column":22,"offset":2611}}}],"position":{"start":{"line":108,"column":1,"offset":2590},"end":{"line":108,"column":22,"offset":2611}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"라며 가볍게 넘길 수는 없는 문제라고 생각합니다.","position":{"start":{"line":110,"column":1,"offset":2613},"end":{"line":110,"column":28,"offset":2640}}}],"position":{"start":{"line":110,"column":1,"offset":2613},"end":{"line":110,"column":28,"offset":2640}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"왜냐하면, DB에 요청하는 쿼리가 결국엔 2배가 되었다는 소리이고 기존 성능에서 2배로 감소했다는 의미이기 때문입니다.","position":{"start":{"line":112,"column":1,"offset":2642},"end":{"line":112,"column":67,"offset":2708}}}],"position":{"start":{"line":112,"column":1,"offset":2642},"end":{"line":112,"column":67,"offset":2708}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"발생-원인","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%EB%B0%9C%EC%83%9D-%EC%9B%90%EC%9D%B8","aria-label":"발생 원인 permalink","class":"anchor-header before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"발생 원인?","position":{"start":{"line":114,"column":4,"offset":2713},"end":{"line":114,"column":10,"offset":2719}}}],"position":{"start":{"line":114,"column":1,"offset":2710},"end":{"line":114,"column":10,"offset":2719}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그렇다면 위와 같은 이슈가 발생되는 원인은 뭘까?","position":{"start":{"line":116,"column":1,"offset":2721},"end":{"line":116,"column":28,"offset":2748}}}],"position":{"start":{"line":116,"column":1,"offset":2721},"end":{"line":116,"column":28,"offset":2748}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이러한 이유는 ","position":{"start":{"line":118,"column":1,"offset":2750},"end":{"line":118,"column":9,"offset":2758}}},{"type":"raw","value":"<code class=\"language-text\">1:N</code>","position":{"start":{"line":118,"column":9,"offset":2758},"end":{"line":118,"column":14,"offset":2763}}},{"type":"text","value":" 관계가 ","position":{"start":{"line":118,"column":14,"offset":2763},"end":{"line":118,"column":19,"offset":2768}}},{"type":"raw","value":"<code class=\"language-text\">단방향</code>","position":{"start":{"line":118,"column":19,"offset":2768},"end":{"line":118,"column":24,"offset":2773}}},{"type":"text","value":"이기 때문입니다.","position":{"start":{"line":118,"column":24,"offset":2773},"end":{"line":118,"column":33,"offset":2782}}}],"position":{"start":{"line":118,"column":1,"offset":2750},"end":{"line":118,"column":33,"offset":2782}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">Rating</code>","position":{"start":{"line":120,"column":1,"offset":2784},"end":{"line":120,"column":9,"offset":2792}}},{"type":"text","value":" 엔티티에 ","position":{"start":{"line":120,"column":9,"offset":2792},"end":{"line":120,"column":15,"offset":2798}}},{"type":"raw","value":"<code class=\"language-text\">reviewId</code>","position":{"start":{"line":120,"column":15,"offset":2798},"end":{"line":120,"column":25,"offset":2808}}},{"type":"text","value":" 컬럼이 추가되기는 했지만, 단방향이기 때문에 ","position":{"start":{"line":120,"column":25,"offset":2808},"end":{"line":120,"column":51,"offset":2834}}},{"type":"raw","value":"<code class=\"language-text\">Rating</code>","position":{"start":{"line":120,"column":51,"offset":2834},"end":{"line":120,"column":59,"offset":2842}}},{"type":"text","value":"은 ","position":{"start":{"line":120,"column":59,"offset":2842},"end":{"line":120,"column":61,"offset":2844}}},{"type":"raw","value":"<code class=\"language-text\">Review</code>","position":{"start":{"line":120,"column":61,"offset":2844},"end":{"line":120,"column":69,"offset":2852}}},{"type":"text","value":"의 존재를 모릅니다.","position":{"start":{"line":120,"column":69,"offset":2852},"end":{"line":120,"column":80,"offset":2863}}}],"position":{"start":{"line":120,"column":1,"offset":2784},"end":{"line":120,"column":80,"offset":2863}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그래서 개별 행 단위로는 ","position":{"start":{"line":122,"column":1,"offset":2865},"end":{"line":122,"column":15,"offset":2879}}},{"type":"raw","value":"<code class=\"language-text\">reviewId</code>","position":{"start":{"line":122,"column":15,"offset":2879},"end":{"line":122,"column":25,"offset":2889}}},{"type":"text","value":"가 없는 채로 ","position":{"start":{"line":122,"column":25,"offset":2889},"end":{"line":122,"column":33,"offset":2897}}},{"type":"raw","value":"<code class=\"language-text\">Rating</code>","position":{"start":{"line":122,"column":33,"offset":2897},"end":{"line":122,"column":41,"offset":2905}}},{"type":"text","value":" 테이블에 Insert되고 먼저 DB에 저장된 이후 Update를 통해서 ","position":{"start":{"line":122,"column":41,"offset":2905},"end":{"line":122,"column":82,"offset":2946}}},{"type":"raw","value":"<code class=\"language-text\">reviewId</code>","position":{"start":{"line":122,"column":82,"offset":2946},"end":{"line":122,"column":92,"offset":2956}}},{"type":"text","value":"를 추가합니다.","position":{"start":{"line":122,"column":92,"offset":2956},"end":{"line":122,"column":100,"offset":2964}}}],"position":{"start":{"line":122,"column":1,"offset":2865},"end":{"line":122,"column":100,"offset":2964}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"그렇다면-해결-방법은","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%EA%B7%B8%EB%A0%87%EB%8B%A4%EB%A9%B4-%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95%EC%9D%80","aria-label":"그렇다면 해결 방법은 permalink","class":"anchor-header before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"그렇다면 해결 방법은?","position":{"start":{"line":124,"column":4,"offset":2969},"end":{"line":124,"column":16,"offset":2981}}}],"position":{"start":{"line":124,"column":1,"offset":2966},"end":{"line":124,"column":16,"offset":2981}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"RDB와 동일한 동작을 원한다면 JPA 엔티티 간의 관계를 ","position":{"start":{"line":126,"column":1,"offset":2983},"end":{"line":126,"column":34,"offset":3016}}},{"type":"raw","value":"<code class=\"language-text\">1:N 단방향</code>","position":{"start":{"line":126,"column":34,"offset":3016},"end":{"line":126,"column":43,"offset":3025}}},{"type":"text","value":" 매핑이 아닌 ","position":{"start":{"line":126,"column":43,"offset":3025},"end":{"line":126,"column":51,"offset":3033}}},{"type":"raw","value":"<code class=\"language-text\">1:N 양방향</code>","position":{"start":{"line":126,"column":51,"offset":3033},"end":{"line":126,"column":60,"offset":3042}}},{"type":"text","value":" 매핑으로 변경시켜야합니다.","position":{"start":{"line":126,"column":60,"offset":3042},"end":{"line":126,"column":75,"offset":3057}}}],"position":{"start":{"line":126,"column":1,"offset":2983},"end":{"line":126,"column":75,"offset":3057}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Review 엔티티","position":{"start":{"line":128,"column":3,"offset":3061},"end":{"line":128,"column":13,"offset":3071}}}],"position":{"start":{"line":128,"column":1,"offset":3059},"end":{"line":128,"column":15,"offset":3073}}}],"position":{"start":{"line":128,"column":1,"offset":3059},"end":{"line":128,"column":15,"offset":3073}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-code-title\">Java</div>"},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Review</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> reviewId<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@ManyToOne</span><span class=\"token punctuation\">(</span>fetch <span class=\"token operator\">=</span> <span class=\"token class-name\">FetchType</span><span class=\"token punctuation\">.</span>LAZY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"reviewerId\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">User</span> reviewer<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@ManyToOne</span><span class=\"token punctuation\">(</span>fetch <span class=\"token operator\">=</span> <span class=\"token class-name\">FetchType</span><span class=\"token punctuation\">.</span>LAZY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"targetId\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">User</span> target<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// mappedBy 추가, 조인 컬럼 삭제</span>\n    <span class=\"token annotation punctuation\">@OneToMany</span><span class=\"token punctuation\">(</span>mappedBy <span class=\"token operator\">=</span> <span class=\"token string\">\"review\"</span><span class=\"token punctuation\">,</span> cascade <span class=\"token operator\">=</span> <span class=\"token class-name\">CascadeType</span><span class=\"token punctuation\">.</span>ALL<span class=\"token punctuation\">,</span> orphanRemoval <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Rating</span><span class=\"token punctuation\">></span></span> rating<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Review</span> <span class=\"token function\">of</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span> reviewer<span class=\"token punctuation\">,</span> <span class=\"token class-name\">User</span> target<span class=\"token punctuation\">,</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Rating</span><span class=\"token punctuation\">></span></span> rating<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Review</span><span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">reviewer</span><span class=\"token punctuation\">(</span>reviewer<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">target</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">rating</span><span class=\"token punctuation\">(</span>rating<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":130,"column":1,"offset":3075},"end":{"line":156,"column":4,"offset":3808}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Rating 엔티티","position":{"start":{"line":158,"column":3,"offset":3812},"end":{"line":158,"column":13,"offset":3822}}}],"position":{"start":{"line":158,"column":1,"offset":3810},"end":{"line":158,"column":15,"offset":3824}}}],"position":{"start":{"line":158,"column":1,"offset":3810},"end":{"line":158,"column":15,"offset":3824}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-code-title\">Java</div>"},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Rating</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> ratingId<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> length <span class=\"token operator\">=</span> <span class=\"token number\">45</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@Enumerated</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">EnumType</span><span class=\"token punctuation\">.</span>STRING<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Content</span> content<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Rating 엔티티에 Review 필드를 추가 (양방향 연결)</span>\n    <span class=\"token annotation punctuation\">@ManyToOne</span><span class=\"token punctuation\">(</span>fetch <span class=\"token operator\">=</span> <span class=\"token class-name\">FetchType</span><span class=\"token punctuation\">.</span>LAZY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"reviewId\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Review</span> review<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 수정</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Rating</span> <span class=\"token function\">of</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Content</span> content<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Review</span> review<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span> \n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Rating</span><span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">content</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">review</span><span class=\"token punctuation\">(</span>review<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":160,"column":1,"offset":3826},"end":{"line":183,"column":4,"offset":4416}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"실행되는 서비스 코드","position":{"start":{"line":185,"column":3,"offset":4420},"end":{"line":185,"column":14,"offset":4431}}}],"position":{"start":{"line":185,"column":1,"offset":4418},"end":{"line":185,"column":16,"offset":4433}}}],"position":{"start":{"line":185,"column":1,"offset":4418},"end":{"line":185,"column":16,"offset":4433}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-code-title\">Java</div>"},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token comment\">/**\n* 특정 사용자에게 리뷰하기\n* @param reviewerId : 리뷰 하는 사용자 ID (현재 사용자)\n* @param targetId : 리뷰 할 사용자 ID\n* @param reviewDto : 리뷰 내용 DTO\n*/</span>\n<span class=\"token annotation punctuation\">@Transactional</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">review</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> reviewerId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span> targetId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ReviewRequest</span> reviewDto<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">User</span> reviewer <span class=\"token operator\">=</span> userRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>reviewerId<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UserNotFoundException</span><span class=\"token operator\">::</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">User</span> target <span class=\"token operator\">=</span> userRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>targetId<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UserNotFoundException</span><span class=\"token operator\">::</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Review</span><span class=\"token punctuation\">></span></span> optional <span class=\"token operator\">=</span> reviewQueryRepository<span class=\"token punctuation\">.</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span>reviewerId<span class=\"token punctuation\">,</span> targetId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>optional<span class=\"token punctuation\">.</span><span class=\"token function\">isPresent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ReviewDuplicatedException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Review</span> review <span class=\"token operator\">=</span> <span class=\"token class-name\">Review</span><span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span>reviewer<span class=\"token punctuation\">,</span> target<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Rating</span><span class=\"token punctuation\">></span></span> ratingList <span class=\"token operator\">=</span> reviewDto<span class=\"token punctuation\">.</span><span class=\"token function\">getRatingList</span><span class=\"token punctuation\">(</span>review<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 수정</span>\n    ratingList<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>rating <span class=\"token operator\">-></span> review<span class=\"token punctuation\">.</span><span class=\"token function\">getRating</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>rating<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    reviewRepository<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>review<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":187,"column":1,"offset":4435},"end":{"line":211,"column":4,"offset":5293}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{"id":"실행-결과-1","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%EC%8B%A4%ED%96%89-%EA%B2%B0%EA%B3%BC-1","aria-label":"실행 결과 1 permalink","class":"anchor-header before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"실행 결과","position":{"start":{"line":213,"column":6,"offset":5300},"end":{"line":213,"column":11,"offset":5305}}}],"position":{"start":{"line":213,"column":1,"offset":5295},"end":{"line":213,"column":12,"offset":5306}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0db50347a22a8795f5973150e1a350fe/2cefc/solution.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.57446808510639%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABLUlEQVQozz1R2W7DMAzLDxVpsKFH4ttOnKNJu3bA/v9LONFo+kBIoiSagiutNfq+hzEGIQSw9t7DOVfizhPWWsQYC59SQpS9fZY186rrFG63G3LOWJYF4zhimibM84xhGNC2bREluEjwUYozV0qh67rSJ1cx2da1uKQII0X5AMF+cSPO6JL9PfLB3eHOV5frFVEWHM8gKYusY+oLd75cCq7itJVrOE+w/oCczNBtFazB3/MH2zxhyQOc6pCDRxQ+GF1gZYnRaznvfPr0vAgYQfsW5TXV3So8xozJGczeYdBdwSRLWQTWGJCNKliCw2h1mR2k50/fUMcDDnWNo6AWVC9v8LsuWETsPvRFdE1B8lTwnOSTnMVrHoWPeOQeWx+RlHzWVwNdH3BsGjRv/ANF1fVRKCVamQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"해결 결과\"\n        title=\"해결 결과\"\n        src=\"/static/0db50347a22a8795f5973150e1a350fe/1d69c/solution.png\"\n        srcset=\"/static/0db50347a22a8795f5973150e1a350fe/4dcb9/solution.png 188w,\n/static/0db50347a22a8795f5973150e1a350fe/5ff7e/solution.png 375w,\n/static/0db50347a22a8795f5973150e1a350fe/1d69c/solution.png 750w,\n/static/0db50347a22a8795f5973150e1a350fe/78797/solution.png 1125w,\n/static/0db50347a22a8795f5973150e1a350fe/2cefc/solution.png 1400w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>","position":{"start":{"line":215,"column":1,"offset":5308},"end":{"line":215,"column":32,"offset":5339}}}],"position":{"start":{"line":215,"column":1,"offset":5308},"end":{"line":215,"column":32,"offset":5339}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"결론","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%EA%B2%B0%EB%A1%A0","aria-label":"결론 permalink","class":"anchor-header before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"결론","position":{"start":{"line":218,"column":4,"offset":5345},"end":{"line":218,"column":6,"offset":5347}}}],"position":{"start":{"line":218,"column":1,"offset":5342},"end":{"line":218,"column":6,"offset":5347}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">1:N 단방향</code>","position":{"start":{"line":220,"column":1,"offset":5349},"end":{"line":220,"column":10,"offset":5358}}},{"type":"text","value":" 매핑은 설정도 간편하고 직관적이지만, Update가 오버헤드로 작용합니다.","position":{"start":{"line":220,"column":10,"offset":5358},"end":{"line":220,"column":52,"offset":5400}}}],"position":{"start":{"line":220,"column":1,"offset":5349},"end":{"line":220,"column":52,"offset":5400}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">@OneToMany</code>","position":{"start":{"line":222,"column":1,"offset":5402},"end":{"line":222,"column":13,"offset":5414}}},{"type":"text","value":"만 붙히는 ","position":{"start":{"line":222,"column":13,"offset":5414},"end":{"line":222,"column":19,"offset":5420}}},{"type":"raw","value":"<code class=\"language-text\">1:N 단방향</code>","position":{"start":{"line":222,"column":19,"offset":5420},"end":{"line":222,"column":28,"offset":5429}}},{"type":"text","value":" 조인 테이블 방식과 ","position":{"start":{"line":222,"column":28,"offset":5429},"end":{"line":222,"column":40,"offset":5441}}},{"type":"raw","value":"<code class=\"language-text\">@JoinColum</code>","position":{"start":{"line":222,"column":40,"offset":5441},"end":{"line":222,"column":52,"offset":5453}}},{"type":"text","value":"만 붙히는 ","position":{"start":{"line":222,"column":52,"offset":5453},"end":{"line":222,"column":58,"offset":5459}}},{"type":"raw","value":"<code class=\"language-text\">1:N 단방향</code>","position":{"start":{"line":222,"column":58,"offset":5459},"end":{"line":222,"column":67,"offset":5468}}},{"type":"text","value":" 조인 컬럼 방식 모두 피해야합니다.","position":{"start":{"line":222,"column":67,"offset":5468},"end":{"line":222,"column":87,"offset":5488}}}],"position":{"start":{"line":222,"column":1,"offset":5402},"end":{"line":222,"column":87,"offset":5488}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"따라서, 1:N에서 N이 큰 상황 또는 모든 상황에서 오버헤드가 없는 ","position":{"start":{"line":224,"column":1,"offset":5490},"end":{"line":224,"column":40,"offset":5529}}},{"type":"raw","value":"<code class=\"language-text\">1:N 양방향</code>","position":{"start":{"line":224,"column":40,"offset":5529},"end":{"line":224,"column":49,"offset":5538}}},{"type":"text","value":" 매핑을 사용하는게 성능에 좋을 것 같습니다 !","position":{"start":{"line":224,"column":49,"offset":5538},"end":{"line":224,"column":75,"offset":5564}}}],"position":{"start":{"line":224,"column":1,"offset":5490},"end":{"line":224,"column":75,"offset":5564}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":224,"column":75,"offset":5564}}}}