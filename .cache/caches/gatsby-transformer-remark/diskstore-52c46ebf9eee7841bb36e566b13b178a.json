{"expireTime":9007200902427766000,"key":"transformer-remark-markdown-ast-0d7034ea530338a86e672dbbbc644360-gatsby-remark-code-titlesgatsby-remark-embed-youtubegatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-custom-blocksgatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":{"type":"root","children":[{"type":"heading","depth":2,"children":[{"type":"link","url":"#-들어가기-전에","title":null,"children":[],"data":{"hProperties":{"aria-label":" 들어가기 전에 permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"⛳ 들어가기 전에..","position":{"start":{"line":4,"column":4,"offset":6},"end":{"line":4,"column":15,"offset":17},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":3},"end":{"line":4,"column":15,"offset":17},"indent":[]},"data":{"id":"-들어가기-전에","htmlAttributes":{"id":"-들어가기-전에"},"hProperties":{"id":"-들어가기-전에","style":"position:relative;"}}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#-상황","title":null,"children":[],"data":{"hProperties":{"aria-label":" 상황 permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"🕹 상황","position":{"start":{"line":6,"column":5,"offset":23},"end":{"line":6,"column":10,"offset":28},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":19},"end":{"line":6,"column":10,"offset":28},"indent":[]},"data":{"id":"-상황","htmlAttributes":{"id":"-상황"},"hProperties":{"id":"-상황","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"사내 ","position":{"start":{"line":7,"column":1,"offset":29},"end":{"line":7,"column":4,"offset":32},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"시스템 모니터링 스택","position":{"start":{"line":7,"column":6,"offset":34},"end":{"line":7,"column":17,"offset":45},"indent":[]}}],"position":{"start":{"line":7,"column":4,"offset":32},"end":{"line":7,"column":19,"offset":47},"indent":[]}},{"type":"text","value":" 개발 중","position":{"start":{"line":7,"column":19,"offset":47},"end":{"line":7,"column":24,"offset":52},"indent":[]}}],"position":{"start":{"line":7,"column":1,"offset":29},"end":{"line":7,"column":24,"offset":52},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#️-기술","title":null,"children":[],"data":{"hProperties":{"aria-label":"️ 기술 permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"⚙️ 기술","position":{"start":{"line":9,"column":5,"offset":58},"end":{"line":9,"column":10,"offset":63},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":54},"end":{"line":9,"column":10,"offset":63},"indent":[]},"data":{"id":"️-기술","htmlAttributes":{"id":"️-기술"},"hProperties":{"id":"️-기술","style":"position:relative;"}}},{"type":"heading","depth":4,"children":[{"type":"link","url":"#data-source","title":null,"children":[],"data":{"hProperties":{"aria-label":"data source permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Data Source","position":{"start":{"line":10,"column":6,"offset":69},"end":{"line":10,"column":17,"offset":80},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":64},"end":{"line":10,"column":18,"offset":81},"indent":[]},"data":{"id":"data-source","htmlAttributes":{"id":"data-source"},"hProperties":{"id":"data-source","style":"position:relative;"}}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"현재 실행되고 있는 각 시스템","position":{"start":{"line":11,"column":3,"offset":84},"end":{"line":11,"column":19,"offset":100},"indent":[]}}],"position":{"start":{"line":11,"column":3,"offset":84},"end":{"line":11,"column":19,"offset":100},"indent":[]}}],"position":{"start":{"line":11,"column":1,"offset":82},"end":{"line":11,"column":19,"offset":100},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"fluentd(로그수집기), nginx(WS), spring-actuator(상태수집), kafka(MQ) 등","position":{"start":{"line":12,"column":3,"offset":103},"end":{"line":12,"column":64,"offset":164},"indent":[]}}],"position":{"start":{"line":12,"column":3,"offset":103},"end":{"line":12,"column":64,"offset":164},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":101},"end":{"line":12,"column":64,"offset":164},"indent":[]}}],"position":{"start":{"line":11,"column":1,"offset":82},"end":{"line":12,"column":64,"offset":164},"indent":[1]}},{"type":"heading","depth":4,"children":[{"type":"link","url":"#prometheus","title":null,"children":[],"data":{"hProperties":{"aria-label":"prometheus permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Prometheus","position":{"start":{"line":14,"column":6,"offset":171},"end":{"line":14,"column":16,"offset":181},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":166},"end":{"line":14,"column":16,"offset":181},"indent":[]},"data":{"id":"prometheus","htmlAttributes":{"id":"prometheus"},"hProperties":{"id":"prometheus","style":"position:relative;"}}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"매트릭 수집기 & 시계열 DB","position":{"start":{"line":15,"column":3,"offset":184},"end":{"line":15,"column":19,"offset":200},"indent":[]}}],"position":{"start":{"line":15,"column":3,"offset":184},"end":{"line":15,"column":19,"offset":200},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":182},"end":{"line":15,"column":19,"offset":200},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"각 시스템에서 보내는 정보를 취합하는 역할","position":{"start":{"line":16,"column":3,"offset":203},"end":{"line":16,"column":26,"offset":226},"indent":[]}}],"position":{"start":{"line":16,"column":3,"offset":203},"end":{"line":16,"column":26,"offset":226},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":201},"end":{"line":16,"column":26,"offset":226},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://prometheus.io/docs/introduction/overview/","children":[{"type":"text","value":"Prometheus란?","position":{"start":{"line":17,"column":4,"offset":230},"end":{"line":17,"column":16,"offset":242},"indent":[]}}],"position":{"start":{"line":17,"column":3,"offset":229},"end":{"line":17,"column":68,"offset":294},"indent":[]}}],"position":{"start":{"line":17,"column":3,"offset":229},"end":{"line":17,"column":68,"offset":294},"indent":[]}}],"position":{"start":{"line":17,"column":1,"offset":227},"end":{"line":17,"column":68,"offset":294},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":182},"end":{"line":17,"column":68,"offset":294},"indent":[1,1]}},{"type":"heading","depth":4,"children":[{"type":"link","url":"#grafana","title":null,"children":[],"data":{"hProperties":{"aria-label":"grafana permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Grafana","position":{"start":{"line":19,"column":6,"offset":301},"end":{"line":19,"column":13,"offset":308},"indent":[]}}],"position":{"start":{"line":19,"column":1,"offset":296},"end":{"line":19,"column":13,"offset":308},"indent":[]},"data":{"id":"grafana","htmlAttributes":{"id":"grafana"},"hProperties":{"id":"grafana","style":"position:relative;"}}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"매트릭을 시각화 하는 대쉬보드의 역할","position":{"start":{"line":20,"column":3,"offset":311},"end":{"line":20,"column":23,"offset":331},"indent":[]}}],"position":{"start":{"line":20,"column":3,"offset":311},"end":{"line":20,"column":23,"offset":331},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":309},"end":{"line":20,"column":23,"offset":331},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://play.grafana.org/d/000000012/grafana-play-home?orgId=1","children":[{"type":"text","value":"Grafana란?","position":{"start":{"line":21,"column":4,"offset":335},"end":{"line":21,"column":13,"offset":344},"indent":[]}}],"position":{"start":{"line":21,"column":3,"offset":334},"end":{"line":21,"column":78,"offset":409},"indent":[]}}],"position":{"start":{"line":21,"column":3,"offset":334},"end":{"line":21,"column":78,"offset":409},"indent":[]}}],"position":{"start":{"line":21,"column":1,"offset":332},"end":{"line":21,"column":78,"offset":409},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":309},"end":{"line":21,"column":78,"offset":409},"indent":[1]}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#-다이어그램","title":null,"children":[],"data":{"hProperties":{"aria-label":" 다이어그램 permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"🎨 다이어그램","position":{"start":{"line":23,"column":5,"offset":415},"end":{"line":23,"column":13,"offset":423},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":411},"end":{"line":23,"column":13,"offset":423},"indent":[]},"data":{"id":"-다이어그램","htmlAttributes":{"id":"-다이어그램"},"hProperties":{"id":"-다이어그램","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"https://user-images.githubusercontent.com/55419159/146768389-a5d3e490-af48-4c14-ad2a-4f3bb0c73d65.png","alt":"image","position":{"start":{"line":25,"column":1,"offset":425},"end":{"line":25,"column":112,"offset":536},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":425},"end":{"line":25,"column":112,"offset":536},"indent":[]}},{"type":"thematicBreak","position":{"start":{"line":27,"column":1,"offset":538},"end":{"line":27,"column":4,"offset":541},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#-개요","title":null,"children":[],"data":{"hProperties":{"aria-label":" 개요 permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"🕹 개요","position":{"start":{"line":29,"column":4,"offset":546},"end":{"line":29,"column":9,"offset":551},"indent":[]}}],"position":{"start":{"line":29,"column":1,"offset":543},"end":{"line":29,"column":9,"offset":551},"indent":[]},"data":{"id":"-개요","htmlAttributes":{"id":"-개요"},"hProperties":{"id":"-개요","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"이 문서에서는 ","position":{"start":{"line":31,"column":1,"offset":553},"end":{"line":31,"column":9,"offset":561},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">nginx-prometheus-exporter</code>","position":{"start":{"line":31,"column":9,"offset":561},"end":{"line":31,"column":36,"offset":588},"indent":[]}},{"type":"text","value":"를 이용해서 ","position":{"start":{"line":31,"column":36,"offset":588},"end":{"line":31,"column":43,"offset":595},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Nginx</code>","position":{"start":{"line":31,"column":43,"offset":595},"end":{"line":31,"column":50,"offset":602},"indent":[]}},{"type":"text","value":"의 커넥션 정보에 대한 메트릭을 수집한다. \n그 후 ","position":{"start":{"line":31,"column":50,"offset":602},"end":{"line":32,"column":5,"offset":631},"indent":[1]}},{"type":"html","value":"<code class=\"language-text\">Grafana</code>","position":{"start":{"line":32,"column":5,"offset":631},"end":{"line":32,"column":14,"offset":640},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":32,"column":14,"offset":640},"end":{"line":32,"column":16,"offset":642},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Prometheus</code>","position":{"start":{"line":32,"column":16,"offset":642},"end":{"line":32,"column":28,"offset":654},"indent":[]}},{"type":"text","value":"를 이용해서 Nginx 웹 서버를 모니터링할 수 있는 대시보드를 구축하는 것에 대하여 다룬다. \n자세한 내용은 다음과 같다.","position":{"start":{"line":32,"column":28,"offset":654},"end":{"line":33,"column":16,"offset":723},"indent":[1]}}],"position":{"start":{"line":31,"column":1,"offset":553},"end":{"line":33,"column":16,"offset":723},"indent":[1,1]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Nginx 설치","position":{"start":{"line":35,"column":3,"offset":727},"end":{"line":35,"column":11,"offset":735},"indent":[]}}],"position":{"start":{"line":35,"column":3,"offset":727},"end":{"line":35,"column":11,"offset":735},"indent":[]}}],"position":{"start":{"line":35,"column":1,"offset":725},"end":{"line":35,"column":11,"offset":735},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"nginx-prometheus-exporter 설치","position":{"start":{"line":36,"column":3,"offset":738},"end":{"line":36,"column":31,"offset":766},"indent":[]}}],"position":{"start":{"line":36,"column":3,"offset":738},"end":{"line":36,"column":31,"offset":766},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":736},"end":{"line":36,"column":31,"offset":766},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"메트릭 수집을 위한 각 컴포넌트 설정","position":{"start":{"line":37,"column":3,"offset":769},"end":{"line":37,"column":23,"offset":789},"indent":[]}}],"position":{"start":{"line":37,"column":3,"offset":769},"end":{"line":37,"column":23,"offset":789},"indent":[]}}],"position":{"start":{"line":37,"column":1,"offset":767},"end":{"line":37,"column":23,"offset":789},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Grafana 대시보드 구축","position":{"start":{"line":38,"column":3,"offset":792},"end":{"line":38,"column":18,"offset":807},"indent":[]}}],"position":{"start":{"line":38,"column":3,"offset":792},"end":{"line":38,"column":18,"offset":807},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":790},"end":{"line":38,"column":18,"offset":807},"indent":[]}}],"position":{"start":{"line":35,"column":1,"offset":725},"end":{"line":38,"column":18,"offset":807},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"https://user-images.githubusercontent.com/55419159/146769477-69fa4854-444c-4dec-b233-86f64d433815.png","alt":"image","position":{"start":{"line":40,"column":1,"offset":809},"end":{"line":40,"column":112,"offset":920},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":809},"end":{"line":40,"column":112,"offset":920},"indent":[]}},{"type":"thematicBreak","position":{"start":{"line":42,"column":1,"offset":922},"end":{"line":42,"column":4,"offset":925},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#-nginx-설치","title":null,"children":[],"data":{"hProperties":{"aria-label":" nginx 설치 permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"🎁 Nginx 설치","position":{"start":{"line":44,"column":4,"offset":930},"end":{"line":44,"column":15,"offset":941},"indent":[]}}],"position":{"start":{"line":44,"column":1,"offset":927},"end":{"line":44,"column":15,"offset":941},"indent":[]},"data":{"id":"-nginx-설치","htmlAttributes":{"id":"-nginx-설치"},"hProperties":{"id":"-nginx-설치","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"Nginx는 대표적인 웹 서버 중 하나로, 가볍고 높은 성능으로 많은 엔지니어들의 사랑(?)을 받고 있다. \n상용 솔루션 뿐 아니라 오픈 소스조차 굉장히 성능이 우수하고, 필요 기능은 공개된 모듈을 통해서 쉽게 커스텀이 가능하기 떄문에 업계 표준으로 자리잡았다.","position":{"start":{"line":45,"column":1,"offset":942},"end":{"line":46,"column":86,"offset":1088},"indent":[1]}}],"position":{"start":{"line":45,"column":1,"offset":942},"end":{"line":46,"column":86,"offset":1088},"indent":[1]}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#로컬환경-설치","title":null,"children":[],"data":{"hProperties":{"aria-label":"로컬환경 설치 permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"로컬환경 설치","position":{"start":{"line":48,"column":5,"offset":1094},"end":{"line":48,"column":12,"offset":1101},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":1090},"end":{"line":48,"column":12,"offset":1101},"indent":[]},"data":{"id":"로컬환경-설치","htmlAttributes":{"id":"로컬환경-설치"},"hProperties":{"id":"로컬환경-설치","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"로컬 환경에서는 다음과 같이 Docker로 간단하게 설치 및 구동 가능하다.","position":{"start":{"line":50,"column":1,"offset":1103},"end":{"line":50,"column":43,"offset":1145},"indent":[]}}],"position":{"start":{"line":50,"column":1,"offset":1103},"end":{"line":50,"column":43,"offset":1145},"indent":[]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ docker run --rm -p <span class=\"token number\">8080</span>:80 nginx</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>","position":{"start":{"line":52,"column":1,"offset":1147},"end":{"line":54,"column":4,"offset":1194},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"다음과 같이 docker-compose로 간단하게 설치 및 구동할 수 있다.","position":{"start":{"line":56,"column":1,"offset":1196},"end":{"line":56,"column":43,"offset":1238},"indent":[]}}],"position":{"start":{"line":56,"column":1,"offset":1196},"end":{"line":56,"column":43,"offset":1238},"indent":[]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token builtin class-name\">pwd</span>\n/Users/jay/Workspace/jay-prometheus/src/\n\n$ docker compose up -d nginx\n<span class=\"token punctuation\">[</span>+<span class=\"token punctuation\">]</span> Running <span class=\"token number\">2</span>/2\n⠿ Network ch04_default  Created                                                                                                                                                                                                   <span class=\"token number\">0</span>.3s\n⠿ Container nginx       Started</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":58,"column":1,"offset":1240},"end":{"line":66,"column":4,"offset":1608},"indent":[1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#서버-설치","title":null,"children":[],"data":{"hProperties":{"aria-label":"서버 설치 permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"서버 설치","position":{"start":{"line":68,"column":5,"offset":1614},"end":{"line":68,"column":10,"offset":1619},"indent":[]}}],"position":{"start":{"line":68,"column":1,"offset":1610},"end":{"line":68,"column":10,"offset":1619},"indent":[]},"data":{"id":"서버-설치","htmlAttributes":{"id":"서버-설치"},"hProperties":{"id":"서버-설치","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"서버 환경에서는 다음 명령어로 설치 및 구동이 가능하다.","position":{"start":{"line":70,"column":1,"offset":1621},"end":{"line":70,"column":32,"offset":1652},"indent":[]}}],"position":{"start":{"line":70,"column":1,"offset":1621},"end":{"line":70,"column":32,"offset":1652},"indent":[]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\"><span class=\"token comment\"># 필요 패키지 설치</span>\n$ <span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> -y yum-utils\n\n<span class=\"token comment\"># nginx 패키지 레포지토리 추가</span>\n$ <span class=\"token function\">sudo</span> <span class=\"token function\">tee</span> /etc/yum.repos.d/nginx.repo <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">EOF\n[nginx-stable]\nname=nginx stable repo\nbaseurl=http://nginx.org/packages/centos/\\<span class=\"token variable\">$releasever</span>/\\<span class=\"token variable\">$basearch</span>/\ngpgcheck=1\nenabled=1\ngpgkey=https://nginx.org/keys/nginx_signing.key\nmodule_hotfixes=true\n\n[nginx-mainline]\nname=nginx mainline repo\nbaseurl=http://nginx.org/packages/mainline/centos/\\<span class=\"token variable\">$releasever</span>/\\<span class=\"token variable\">$basearch</span>/\ngpgcheck=1\nenabled=0\ngpgkey=https://nginx.org/keys/nginx_signing.key\nmodule_hotfixes=true\nEOF</span>\n\n<span class=\"token comment\"># nginx 레포지토리 선택</span>\n$ <span class=\"token function\">sudo</span> yum-config-manager --enable nginx-stable\n\n<span class=\"token comment\"># nginx 설치</span>\n$ <span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> -y nginx\n\n<span class=\"token comment\"># nginx 구동</span>\n$ <span class=\"token function\">sudo</span> systemctl restart nginx\n\n<span class=\"token comment\"># nginx 구동 상태 확인</span>\n$ <span class=\"token function\">sudo</span> systemctl status nginx\n● nginx.service - nginx - high performance web server\nLoaded: loaded <span class=\"token punctuation\">(</span>/usr/lib/systemd/system/nginx.service<span class=\"token punctuation\">;</span> disabled<span class=\"token punctuation\">;</span> vendor preset: dis<span class=\"token operator\">></span>\nActive: active <span class=\"token punctuation\">(</span>running<span class=\"token punctuation\">)</span> since Thu <span class=\"token number\">2021</span>-07-22 02:20:48 UTC<span class=\"token punctuation\">;</span> 4s ago\nDocs: http://nginx.org/en/docs/\nProcess: <span class=\"token number\">2037</span> <span class=\"token assign-left variable\">ExecStart</span><span class=\"token operator\">=</span>/usr/sbin/nginx -c /etc/nginx/nginx.conf <span class=\"token punctuation\">(</span>code<span class=\"token operator\">=</span>exited, statu<span class=\"token operator\">></span>\n<span class=\"token punctuation\">..</span>.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":73,"column":1,"offset":1655},"end":{"line":113,"column":4,"offset":2710},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#설치-결과","title":null,"children":[],"data":{"hProperties":{"aria-label":"설치 결과 permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"설치 결과","position":{"start":{"line":115,"column":5,"offset":2716},"end":{"line":115,"column":10,"offset":2721},"indent":[]}}],"position":{"start":{"line":115,"column":1,"offset":2712},"end":{"line":115,"column":10,"offset":2721},"indent":[]},"data":{"id":"설치-결과","htmlAttributes":{"id":"설치-결과"},"hProperties":{"id":"설치-결과","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"그 후 터미널에 다음을 입력하면 다음 결과를 얻을 수 있다.","position":{"start":{"line":116,"column":1,"offset":2722},"end":{"line":116,"column":34,"offset":2755},"indent":[]}}],"position":{"start":{"line":116,"column":1,"offset":2722},"end":{"line":116,"column":34,"offset":2755},"indent":[]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\"><span class=\"token comment\"># 로컬의 경우</span>\n$ <span class=\"token function\">curl</span> localhost:8080\n\n<span class=\"token comment\"># 서버의 경우</span>\n$ <span class=\"token function\">curl</span> localhost\n\n<span class=\"token comment\"># 결과 출력</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span>DOCTYPE html<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>html<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>head<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>title<span class=\"token operator\">></span>Welcome to nginx<span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span>/title<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>style<span class=\"token operator\">></span>\n    body <span class=\"token punctuation\">{</span>\n        width: 35em<span class=\"token punctuation\">;</span>\n        margin: <span class=\"token number\">0</span> auto<span class=\"token punctuation\">;</span>\n        font-family: Tahoma, Verdana, Arial, sans-serif<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token operator\">&lt;</span>/style<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>/head<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>body<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>h<span class=\"token operator\"><span class=\"token file-descriptor important\">1</span>></span>Welcome to nginx<span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span>/h<span class=\"token operator\"><span class=\"token file-descriptor important\">1</span>></span>\n<span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span>If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required.<span class=\"token operator\">&lt;</span>/p<span class=\"token operator\">></span>\n\n<span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span>For online documentation and support please refer to\n<span class=\"token operator\">&lt;</span>a <span class=\"token assign-left variable\">href</span><span class=\"token operator\">=</span><span class=\"token string\">\"http://nginx.org/\"</span><span class=\"token operator\">></span>nginx.org<span class=\"token operator\">&lt;</span>/a<span class=\"token operator\">></span>.<span class=\"token operator\">&lt;</span>br/<span class=\"token operator\">></span>\nCommercial support is available at\n<span class=\"token operator\">&lt;</span>a <span class=\"token assign-left variable\">href</span><span class=\"token operator\">=</span><span class=\"token string\">\"http://nginx.com/\"</span><span class=\"token operator\">></span>nginx.com<span class=\"token operator\">&lt;</span>/a<span class=\"token operator\">></span>.<span class=\"token operator\">&lt;</span>/p<span class=\"token operator\">></span>\n\n<span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>em<span class=\"token operator\">></span>Thank you <span class=\"token keyword\">for</span> using nginx.<span class=\"token operator\">&lt;</span>/em<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>/p<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>/body<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>/html<span class=\"token operator\">></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":119,"column":1,"offset":2758},"end":{"line":152,"column":4,"offset":3449},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"thematicBreak","position":{"start":{"line":154,"column":1,"offset":3451},"end":{"line":154,"column":4,"offset":3454},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#-nginx-prometheus-exporter-설치","title":null,"children":[],"data":{"hProperties":{"aria-label":" nginx prometheus exporter 설치 permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"⏰ nginx-prometheus-exporter 설치","position":{"start":{"line":156,"column":4,"offset":3459},"end":{"line":156,"column":34,"offset":3489},"indent":[]}}],"position":{"start":{"line":156,"column":1,"offset":3456},"end":{"line":156,"column":34,"offset":3489},"indent":[]},"data":{"id":"-nginx-prometheus-exporter-설치","htmlAttributes":{"id":"-nginx-prometheus-exporter-설치"},"hProperties":{"id":"-nginx-prometheus-exporter-설치","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"웹 서버를 모니터링할 때 가장 중요하게 생각되는 지표는 다음과 같다. (물론 더 많을 수 있다.)","position":{"start":{"line":158,"column":1,"offset":3491},"end":{"line":158,"column":55,"offset":3545},"indent":[]}}],"position":{"start":{"line":158,"column":1,"offset":3491},"end":{"line":158,"column":55,"offset":3545},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Connection 개수","position":{"start":{"line":160,"column":3,"offset":3549},"end":{"line":160,"column":16,"offset":3562},"indent":[]}}],"position":{"start":{"line":160,"column":3,"offset":3549},"end":{"line":160,"column":16,"offset":3562},"indent":[]}}],"position":{"start":{"line":160,"column":1,"offset":3547},"end":{"line":160,"column":16,"offset":3562},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Connection 상태","position":{"start":{"line":161,"column":3,"offset":3565},"end":{"line":161,"column":16,"offset":3578},"indent":[]}}],"position":{"start":{"line":161,"column":3,"offset":3565},"end":{"line":161,"column":16,"offset":3578},"indent":[]}}],"position":{"start":{"line":161,"column":1,"offset":3563},"end":{"line":161,"column":16,"offset":3578},"indent":[]}}],"position":{"start":{"line":160,"column":1,"offset":3547},"end":{"line":161,"column":16,"offset":3578},"indent":[1]}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">Nginx</code>","position":{"start":{"line":163,"column":1,"offset":3580},"end":{"line":163,"column":8,"offset":3587},"indent":[]}},{"type":"text","value":"의 ","position":{"start":{"line":163,"column":8,"offset":3587},"end":{"line":163,"column":10,"offset":3589},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">stub_status</code>","position":{"start":{"line":163,"column":10,"offset":3589},"end":{"line":163,"column":23,"offset":3602},"indent":[]}},{"type":"text","value":" 모듈을 활성화시키면 이런 커넥션 정보를 얻을 수 있다. \n오픈 소스에는 볼 수 있는 지표가 적지만, 상용 버전에는 꽤 많은 지표를 확인할 수 있다. ","position":{"start":{"line":163,"column":23,"offset":3602},"end":{"line":164,"column":52,"offset":3686},"indent":[1]}}],"position":{"start":{"line":163,"column":1,"offset":3580},"end":{"line":164,"column":52,"offset":3686},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"하지만 모듈을 활성화시켰다고 해서, 커넥션에 대한 메트릭이 자동적으로 수집되는 것은 아니다.\n이를 위해서 ","position":{"start":{"line":166,"column":1,"offset":3688},"end":{"line":167,"column":8,"offset":3747},"indent":[1]}},{"type":"html","value":"<code class=\"language-text\">Nginx</code>","position":{"start":{"line":167,"column":8,"offset":3747},"end":{"line":167,"column":15,"offset":3754},"indent":[]}},{"type":"text","value":" 재단은 ","position":{"start":{"line":167,"column":15,"offset":3754},"end":{"line":167,"column":20,"offset":3759},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">nginx-prometheus-exporter</code>","position":{"start":{"line":167,"column":20,"offset":3759},"end":{"line":167,"column":47,"offset":3786},"indent":[]}},{"type":"text","value":"라는 것을 만들고 오픈 소스로 배포해두었다.\n우리는 ","position":{"start":{"line":167,"column":47,"offset":3786},"end":{"line":168,"column":5,"offset":3815},"indent":[1]}},{"type":"html","value":"<code class=\"language-text\">Nginx</code>","position":{"start":{"line":168,"column":5,"offset":3815},"end":{"line":168,"column":12,"offset":3822},"indent":[]}},{"type":"text","value":" 웹 서버를 모니터링하기 위해서 이 ","position":{"start":{"line":168,"column":12,"offset":3822},"end":{"line":168,"column":32,"offset":3842},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Exporter</code>","position":{"start":{"line":168,"column":32,"offset":3842},"end":{"line":168,"column":42,"offset":3852},"indent":[]}},{"type":"text","value":"를 사용할 것이다.","position":{"start":{"line":168,"column":42,"offset":3852},"end":{"line":168,"column":52,"offset":3862},"indent":[]}}],"position":{"start":{"line":166,"column":1,"offset":3688},"end":{"line":168,"column":52,"offset":3862},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"먼저 로컬에서는 다음과 같이 설치가 가능하다.","position":{"start":{"line":170,"column":1,"offset":3864},"end":{"line":170,"column":26,"offset":3889},"indent":[]}}],"position":{"start":{"line":170,"column":1,"offset":3864},"end":{"line":170,"column":26,"offset":3889},"indent":[]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ docker pull nginx/nginx-prometheus-exporter:latest</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>","position":{"start":{"line":173,"column":1,"offset":3892},"end":{"line":175,"column":4,"offset":3957},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">Nginx</code>","position":{"start":{"line":178,"column":1,"offset":3960},"end":{"line":178,"column":8,"offset":3967},"indent":[]}},{"type":"text","value":"의 ","position":{"start":{"line":178,"column":8,"offset":3967},"end":{"line":178,"column":10,"offset":3969},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">stub_status</code>","position":{"start":{"line":178,"column":10,"offset":3969},"end":{"line":178,"column":23,"offset":3982},"indent":[]}},{"type":"text","value":" 모듈이 활성화 되어야 실행할 수 있다.","position":{"start":{"line":178,"column":23,"offset":3982},"end":{"line":178,"column":45,"offset":4004},"indent":[]}}],"position":{"start":{"line":178,"column":1,"offset":3960},"end":{"line":178,"column":45,"offset":4004},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#로컬환경-설치-1","title":null,"children":[],"data":{"hProperties":{"aria-label":"로컬환경 설치 1 permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"로컬환경 설치","position":{"start":{"line":180,"column":5,"offset":4010},"end":{"line":180,"column":12,"offset":4017},"indent":[]}}],"position":{"start":{"line":180,"column":1,"offset":4006},"end":{"line":180,"column":12,"offset":4017},"indent":[]},"data":{"id":"로컬환경-설치-1","htmlAttributes":{"id":"로컬환경-설치-1"},"hProperties":{"id":"로컬환경-설치-1","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"역시 이 장의 코드를 다운 받았다면, 다음과 같이 ","position":{"start":{"line":183,"column":1,"offset":4020},"end":{"line":183,"column":29,"offset":4048},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">docker-compose</code>","position":{"start":{"line":183,"column":29,"offset":4048},"end":{"line":183,"column":45,"offset":4064},"indent":[]}},{"type":"text","value":"로 간단하게 설치 및 구동할 수 있다.","position":{"start":{"line":183,"column":45,"offset":4064},"end":{"line":183,"column":66,"offset":4085},"indent":[]}}],"position":{"start":{"line":183,"column":1,"offset":4020},"end":{"line":183,"column":66,"offset":4085},"indent":[]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token builtin class-name\">pwd</span>\n/Users/gurumee/Workspace/gurumee-book-prometheus/src/part2/ch06\n\n$ docker compose up -d nginx-prometheus-exporter\n<span class=\"token punctuation\">[</span>+<span class=\"token punctuation\">]</span> Running <span class=\"token number\">1</span>/1\n⠿ Container nginx-prometheus-exporter  Started</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":185,"column":1,"offset":4087},"end":{"line":192,"column":4,"offset":4282},"indent":[1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#서버-설치-1","title":null,"children":[],"data":{"hProperties":{"aria-label":"서버 설치 1 permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"서버 설치","position":{"start":{"line":194,"column":5,"offset":4288},"end":{"line":194,"column":10,"offset":4293},"indent":[]}}],"position":{"start":{"line":194,"column":1,"offset":4284},"end":{"line":194,"column":10,"offset":4293},"indent":[]},"data":{"id":"서버-설치-1","htmlAttributes":{"id":"서버-설치-1"},"hProperties":{"id":"서버-설치-1","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"서버 환경에서는 다음 명령어로 설치할 수 있다.","position":{"start":{"line":196,"column":1,"offset":4295},"end":{"line":196,"column":27,"offset":4321},"indent":[]}}],"position":{"start":{"line":196,"column":1,"offset":4295},"end":{"line":196,"column":27,"offset":4321},"indent":[]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\"><span class=\"token comment\"># 디렉토리 생성</span>\n$ <span class=\"token function\">mkdir</span> -p ~/apps/nginx-prometheus-exporter\n\n<span class=\"token comment\"># 압축 파일 다운로드</span>\n$ <span class=\"token function\">wget</span> https://github.com/nginxinc/nginx-prometheus-exporter/releases/download/v0.9.0/nginx-prometheus-exporter_0.9.0_linux_amd64.tar.gz\n\n<span class=\"token comment\"># 압축 파일 해제 및 경로 지정</span>\n$ <span class=\"token function\">tar</span> xvf nginx-prometheus-exporter_0.9.0_linux_amd64.tar.gz -C ~/apps/nginx-prometheus-exporter\n\n<span class=\"token comment\"># 압축 파일 삭제</span>\n$ <span class=\"token function\">rm</span> nginx-prometheus-exporter_0.9.0_linux_amd64.tar.gz\n\n<span class=\"token comment\"># 경로 이동</span>\n$ <span class=\"token builtin class-name\">cd</span> ~/apps/nginx-prometheus-exporter\n\n<span class=\"token comment\"># nginx-prometheus-exporter 실행</span>\n$ ./nginx-prometheus-exporter\n<span class=\"token number\">2021</span>/07/22 <span class=\"token number\">10</span>:05:50 Starting NGINX Prometheus Exporter <span class=\"token assign-left variable\">version</span><span class=\"token operator\">=</span><span class=\"token number\">0.9</span>.0 <span class=\"token assign-left variable\">commit</span><span class=\"token operator\">=</span>5f88afbd906baae02edfbab4f5715e06d88538a0 <span class=\"token assign-left variable\">date</span><span class=\"token operator\">=</span><span class=\"token number\">2021</span>-03-22T20:16:09Z\n<span class=\"token number\">2021</span>/07/22 <span class=\"token number\">10</span>:05:50 Could not create Nginx Client: failed to get http://127.0.0.1:8080/stub_status: Get <span class=\"token string\">\"http://127.0.0.1:8080/stub_status\"</span><span class=\"token builtin class-name\">:</span> dial tcp <span class=\"token number\">127.0</span>.0.1:8080: connect:\nconnection refused</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":197,"column":1,"offset":4322},"end":{"line":218,"column":4,"offset":5170},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"역시 구동은 되지 않는다. 이제 쉽게 구동하기 위해서 서비스 파일로 등록해보자.","position":{"start":{"line":221,"column":1,"offset":5173},"end":{"line":221,"column":45,"offset":5217},"indent":[]}}],"position":{"start":{"line":221,"column":1,"offset":5173},"end":{"line":221,"column":45,"offset":5217},"indent":[]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token builtin class-name\">pwd</span>\n/home/sidelineowl/apps/nginx-prometheus-exporter\n\n<span class=\"token comment\"># user 추가</span>\n$ <span class=\"token function\">sudo</span> <span class=\"token function\">useradd</span> -M -r -s /bin/false nginx_prometheus_exporter\n\n<span class=\"token comment\"># 실행 파일 /usr/local/bin/으로 경로 이동</span>\n$ <span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> ./nginx-prometheus-exporter /usr/local/bin\n\n<span class=\"token comment\"># /usr/local/bin/nginx-prometheus-exporter nginx_prometheus_exporter 유저, 그룹 권한 주기</span>\n$ <span class=\"token function\">sudo</span> <span class=\"token function\">chown</span> nginx_prometheus_exporter:nginx_prometheus_exporter /usr/local/bin/nginx-prometheus-exporter\n\n<span class=\"token comment\"># 서비스 파일 등록</span>\n$ <span class=\"token function\">sudo</span> <span class=\"token function\">tee</span> /etc/systemd/system/nginx_prometheus_exporter.service <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">EOF\n[Unit]\nDescription=Nginx Prometheus Exporter\nWants=network-online.target\nAfter=network-online.target\n\n[Service]\nUser=nginx_prometheus_exporter\nGroup=nginx_prometheus_exporter\nType=simple\nExecStart=/usr/local/bin/nginx-prometheus-exporter -nginx.scrape-uri http://localhost/metrics\n\n[Install]\nWantedBy=multi-user.target\nEOF</span>\n\n<span class=\"token comment\"># 데몬 리로드</span>\n<span class=\"token comment\"># sudo systemctl daemon-reload</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":223,"column":1,"offset":5219},"end":{"line":255,"column":4,"offset":6082},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#실행","title":null,"children":[],"data":{"hProperties":{"aria-label":"실행 permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"실행","position":{"start":{"line":257,"column":5,"offset":6088},"end":{"line":257,"column":7,"offset":6090},"indent":[]}}],"position":{"start":{"line":257,"column":1,"offset":6084},"end":{"line":257,"column":7,"offset":6090},"indent":[]},"data":{"id":"실행","htmlAttributes":{"id":"실행"},"hProperties":{"id":"실행","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"이제 서비스 구동을 해보자.","position":{"start":{"line":259,"column":1,"offset":6092},"end":{"line":259,"column":16,"offset":6107},"indent":[]}}],"position":{"start":{"line":259,"column":1,"offset":6092},"end":{"line":259,"column":16,"offset":6107},"indent":[]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\"><span class=\"token comment\"># 서비스 구동</span>\n$ <span class=\"token function\">sudo</span> systemctl restart nginx_prometheus_exporter\n\n<span class=\"token comment\"># 서비스 상태 확인</span>\n$ <span class=\"token function\">sudo</span> systemctl status nginx_prometheus_exporter\n● nginx_prometheus_exporter.service - Nginx Prometheus Exporter\nLoaded: loaded <span class=\"token punctuation\">(</span>/etc/systemd/system/nginx_prometheus_exporter.service<span class=\"token punctuation\">;</span> disabled<span class=\"token punctuation\">;</span> vendor preset: disabled<span class=\"token punctuation\">)</span>\nActive: failed <span class=\"token punctuation\">(</span>Result: exit-code<span class=\"token punctuation\">)</span> since Thu <span class=\"token number\">2021</span>-07-22 <span class=\"token number\">10</span>:12:10 UTC<span class=\"token punctuation\">;</span> 21s ago\nProcess: <span class=\"token number\">4110</span> <span class=\"token assign-left variable\">ExecStart</span><span class=\"token operator\">=</span>/usr/local/bin/nginx-prometheus-exporter -nginx.scrape-uri http://localhost/metrics <span class=\"token punctuation\">(</span>code<span class=\"token operator\">=</span>exited, <span class=\"token assign-left variable\">status</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>/FAILURE<span class=\"token punctuation\">)</span>\nMain PID: <span class=\"token number\">4110</span> <span class=\"token punctuation\">(</span>code<span class=\"token operator\">=</span>exited, <span class=\"token assign-left variable\">status</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>/FAILURE<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">..</span>.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":261,"column":1,"offset":6109},"end":{"line":273,"column":4,"offset":6683},"indent":[1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">-nginx.scrape-url</code>","position":{"start":{"line":276,"column":1,"offset":6686},"end":{"line":276,"column":20,"offset":6705},"indent":[]}},{"type":"text","value":"로 설정한 엔드포인트에 ","position":{"start":{"line":276,"column":20,"offset":6705},"end":{"line":276,"column":33,"offset":6718},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">stub_status</code>","position":{"start":{"line":276,"column":33,"offset":6718},"end":{"line":276,"column":46,"offset":6731},"indent":[]}},{"type":"text","value":" 모듈이 활성화되지 않아서 역시 구동은 안된다.\n여기까지 왔으면 성공이다.","position":{"start":{"line":276,"column":46,"offset":6731},"end":{"line":277,"column":15,"offset":6772},"indent":[1]}}],"position":{"start":{"line":276,"column":1,"offset":6686},"end":{"line":277,"column":15,"offset":6772},"indent":[1]}},{"type":"thematicBreak","position":{"start":{"line":279,"column":1,"offset":6774},"end":{"line":279,"column":4,"offset":6777},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#-메트릭-수집을-위한-각-컴포넌트-설정","title":null,"children":[],"data":{"hProperties":{"aria-label":" 메트릭 수집을 위한 각 컴포넌트 설정 permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"🏮 메트릭 수집을 위한 각 컴포넌트 설정","position":{"start":{"line":281,"column":4,"offset":6782},"end":{"line":281,"column":27,"offset":6805},"indent":[]}}],"position":{"start":{"line":281,"column":1,"offset":6779},"end":{"line":281,"column":27,"offset":6805},"indent":[]},"data":{"id":"-메트릭-수집을-위한-각-컴포넌트-설정","htmlAttributes":{"id":"-메트릭-수집을-위한-각-컴포넌트-설정"},"hProperties":{"id":"-메트릭-수집을-위한-각-컴포넌트-설정","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"이제 ","position":{"start":{"line":283,"column":1,"offset":6807},"end":{"line":283,"column":4,"offset":6810},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Nginx</code>","position":{"start":{"line":283,"column":4,"offset":6810},"end":{"line":283,"column":11,"offset":6817},"indent":[]}},{"type":"text","value":"의 ","position":{"start":{"line":283,"column":11,"offset":6817},"end":{"line":283,"column":13,"offset":6819},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">stub_status</code>","position":{"start":{"line":283,"column":13,"offset":6819},"end":{"line":283,"column":26,"offset":6832},"indent":[]}},{"type":"text","value":" 모듈을 활성화시킨다. \n","position":{"start":{"line":283,"column":26,"offset":6832},"end":{"line":284,"column":1,"offset":6846},"indent":[1]}},{"type":"html","value":"<code class=\"language-text\">/metrics</code>","position":{"start":{"line":284,"column":1,"offset":6846},"end":{"line":284,"column":11,"offset":6856},"indent":[]}},{"type":"text","value":" 엔드포인트에 이 모듈이 수집하는 메트릭을 노출시킬 것이다.","position":{"start":{"line":284,"column":11,"offset":6856},"end":{"line":284,"column":44,"offset":6889},"indent":[]}}],"position":{"start":{"line":283,"column":1,"offset":6807},"end":{"line":284,"column":44,"offset":6889},"indent":[1]}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">Nginx</code>","position":{"start":{"line":286,"column":1,"offset":6891},"end":{"line":286,"column":8,"offset":6898},"indent":[]}},{"type":"text","value":" 설정 파일을 다음과 같이 수정한다.\n서버 환경에서는 ","position":{"start":{"line":286,"column":8,"offset":6898},"end":{"line":287,"column":10,"offset":6928},"indent":[1]}},{"type":"html","value":"<code class=\"language-text\">/etc/nginx/nginx.conf</code>","position":{"start":{"line":287,"column":10,"offset":6928},"end":{"line":287,"column":33,"offset":6951},"indent":[]}},{"type":"text","value":"를 수정하면 된다. \n(로컬 환경에서는 ","position":{"start":{"line":287,"column":33,"offset":6951},"end":{"line":288,"column":11,"offset":6973},"indent":[1]}},{"type":"html","value":"<code class=\"language-text\">docker compose</code>","position":{"start":{"line":288,"column":11,"offset":6973},"end":{"line":288,"column":27,"offset":6989},"indent":[]}},{"type":"text","value":"로 모든 컴포넌트를 구동만 하면 된다.)","position":{"start":{"line":288,"column":27,"offset":6989},"end":{"line":288,"column":49,"offset":7011},"indent":[]}}],"position":{"start":{"line":286,"column":1,"offset":6891},"end":{"line":288,"column":49,"offset":7011},"indent":[1,1]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">user  nginx<span class=\"token punctuation\">;</span>\nworker_processes  <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\nerror_log  /var/log/nginx/error.log warn<span class=\"token punctuation\">;</span>\npid        /var/run/nginx.pid<span class=\"token punctuation\">;</span>\n\n\nevents <span class=\"token punctuation\">{</span>\nworker_connections  <span class=\"token number\">1024</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nhttp <span class=\"token punctuation\">{</span>\ninclude       /etc/nginx/mime.types<span class=\"token punctuation\">;</span>\ndefault_type  application/octet-stream<span class=\"token punctuation\">;</span>\n\n    log_format  main  <span class=\"token string\">'$remote_addr - $remote_user [$time_local] \"$request\" '</span>\n                      <span class=\"token string\">'$status $body_bytes_sent \"$http_referer\" '</span>\n                      <span class=\"token string\">'\"$http_user_agent\" \"$http_x_forwarded_for\"'</span><span class=\"token punctuation\">;</span>\n\n    access_log  /var/log/nginx/access.log  main<span class=\"token punctuation\">;</span>\n    sendfile        on<span class=\"token punctuation\">;</span>\n    keepalive_timeout  <span class=\"token number\">65</span><span class=\"token punctuation\">;</span>\n\n    server <span class=\"token punctuation\">{</span>\n        listen <span class=\"token number\">80</span><span class=\"token punctuation\">;</span>\n        proxy_set_header     X-Scope-OrgID docker-ha<span class=\"token punctuation\">;</span>\n\n         location / <span class=\"token punctuation\">{</span>\n            root   /usr/share/nginx/html<span class=\"token punctuation\">;</span>\n            index  index.html index.htm<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\"># stub_status 모듈 활성</span>\n        location /metrics <span class=\"token punctuation\">{</span>\n            stub_status on<span class=\"token punctuation\">;</span>\n            access_log off<span class=\"token punctuation\">;</span>\n            allow all<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":290,"column":1,"offset":7013},"end":{"line":331,"column":4,"offset":7928},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"그리고 ","position":{"start":{"line":334,"column":1,"offset":7931},"end":{"line":334,"column":5,"offset":7935},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Nginx</code>","position":{"start":{"line":334,"column":5,"offset":7935},"end":{"line":334,"column":12,"offset":7942},"indent":[]}},{"type":"text","value":"를 재가동한다.","position":{"start":{"line":334,"column":12,"offset":7942},"end":{"line":334,"column":20,"offset":7950},"indent":[]}}],"position":{"start":{"line":334,"column":1,"offset":7931},"end":{"line":334,"column":20,"offset":7950},"indent":[]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">sudo</span> systemctl restart nginx</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>","position":{"start":{"line":336,"column":1,"offset":7952},"end":{"line":338,"column":4,"offset":7995},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"이제 ","position":{"start":{"line":340,"column":1,"offset":7997},"end":{"line":340,"column":4,"offset":8000},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">curl</code>","position":{"start":{"line":340,"column":4,"offset":8000},"end":{"line":340,"column":10,"offset":8006},"indent":[]}},{"type":"text","value":"로 한 번 확인을 해보자.","position":{"start":{"line":340,"column":10,"offset":8006},"end":{"line":340,"column":24,"offset":8020},"indent":[]}}],"position":{"start":{"line":340,"column":1,"offset":7997},"end":{"line":340,"column":24,"offset":8020},"indent":[]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">curl</span> localhost/metrics\nActive connections: <span class=\"token number\">1</span>\nserver accepts handled requests\n<span class=\"token number\">1</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span>\nReading: <span class=\"token number\">0</span> Writing: <span class=\"token number\">1</span> Waiting: <span class=\"token number\">0</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":342,"column":1,"offset":8022},"end":{"line":348,"column":4,"offset":8152},"indent":[1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"이렇게 나오면 성공이다. ","position":{"start":{"line":351,"column":1,"offset":8155},"end":{"line":351,"column":15,"offset":8169},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">nginx-prometheus-exporter</code>","position":{"start":{"line":351,"column":15,"offset":8169},"end":{"line":351,"column":42,"offset":8196},"indent":[]}},{"type":"text","value":" 서비스를 재구동한다.","position":{"start":{"line":351,"column":42,"offset":8196},"end":{"line":351,"column":54,"offset":8208},"indent":[]}}],"position":{"start":{"line":351,"column":1,"offset":8155},"end":{"line":351,"column":54,"offset":8208},"indent":[]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">sudo</span> systemctl restart nginx_prometheus_exporter</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>","position":{"start":{"line":353,"column":1,"offset":8210},"end":{"line":355,"column":4,"offset":8273},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"그 후 ","position":{"start":{"line":358,"column":1,"offset":8276},"end":{"line":358,"column":5,"offset":8280},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">curl</code>","position":{"start":{"line":358,"column":5,"offset":8280},"end":{"line":358,"column":11,"offset":8286},"indent":[]}},{"type":"text","value":"로 메트릭이 수집되는지 확인해보자.","position":{"start":{"line":358,"column":11,"offset":8286},"end":{"line":358,"column":30,"offset":8305},"indent":[]}}],"position":{"start":{"line":358,"column":1,"offset":8276},"end":{"line":358,"column":30,"offset":8305},"indent":[]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">curl</span> localhost:9113/metrics\n<span class=\"token comment\"># HELP nginx_connections_accepted Accepted client connections</span>\n<span class=\"token comment\"># TYPE nginx_connections_accepted counter</span>\nnginx_connections_accepted <span class=\"token number\">2</span>\n<span class=\"token comment\"># HELP nginx_connections_active Active client connections</span>\n<span class=\"token comment\"># TYPE nginx_connections_active gauge</span>\nnginx_connections_active <span class=\"token number\">1</span>\n<span class=\"token comment\"># HELP nginx_connections_handled Handled client connections</span>\n<span class=\"token comment\"># TYPE nginx_connections_handled counter</span>\nnginx_connections_handled <span class=\"token number\">2</span>\n<span class=\"token comment\"># HELP nginx_connections_reading Connections where NGINX is reading the request header</span>\n<span class=\"token comment\"># TYPE nginx_connections_reading gauge</span>\nnginx_connections_reading <span class=\"token number\">0</span>\n<span class=\"token comment\"># HELP nginx_connections_waiting Idle client connections</span>\n<span class=\"token comment\"># TYPE nginx_connections_waiting gauge</span>\nnginx_connections_waiting <span class=\"token number\">0</span>\n<span class=\"token punctuation\">..</span>.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":360,"column":1,"offset":8307},"end":{"line":378,"column":4,"offset":9016},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"이제 ","position":{"start":{"line":381,"column":1,"offset":9019},"end":{"line":381,"column":4,"offset":9022},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Prometheus</code>","position":{"start":{"line":381,"column":4,"offset":9022},"end":{"line":381,"column":16,"offset":9034},"indent":[]}},{"type":"text","value":" 설정 파일을 다음과 같이 수정한다. \n서버에서라면 ","position":{"start":{"line":381,"column":16,"offset":9034},"end":{"line":382,"column":8,"offset":9063},"indent":[1]}},{"type":"html","value":"<code class=\"language-text\">/etc/prometheus/prometheus.yml</code>","position":{"start":{"line":382,"column":8,"offset":9063},"end":{"line":382,"column":40,"offset":9095},"indent":[]}},{"type":"text","value":"에 있다.","position":{"start":{"line":382,"column":40,"offset":9095},"end":{"line":382,"column":45,"offset":9100},"indent":[]}}],"position":{"start":{"line":381,"column":1,"offset":9019},"end":{"line":382,"column":45,"offset":9100},"indent":[1]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\"><span class=\"token comment\"># my global config</span>\nglobal:\nscrape_interval:     15s <span class=\"token comment\"># By default, scrape targets every 15 seconds.</span>\nevaluation_interval: 15s <span class=\"token comment\"># By default, scrape targets every 15 seconds.</span>\n\nexternal_labels:\nmonitor: <span class=\"token string\">'my-project'</span>\n\nrule_files:\n\nscrape_configs:\n<span class=\"token comment\"># ...</span>\n\n- job_name: <span class=\"token string\">'nginx-prometheus-exporter'</span>\n  scrape_interval: 5s\n\n  static_configs:\n  <span class=\"token comment\"># nginx와 nginx-prometheus-exporter가 설치된 IP:9113</span>\n    - targets: <span class=\"token punctuation\">[</span><span class=\"token string\">'nginx-prometheus-exporter:9113'</span><span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":384,"column":1,"offset":9102},"end":{"line":404,"column":4,"offset":9543},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"그리고 ","position":{"start":{"line":406,"column":1,"offset":9545},"end":{"line":406,"column":5,"offset":9549},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Prometheus</code>","position":{"start":{"line":406,"column":5,"offset":9549},"end":{"line":406,"column":17,"offset":9561},"indent":[]}},{"type":"text","value":"를 재구동한다.","position":{"start":{"line":406,"column":17,"offset":9561},"end":{"line":406,"column":25,"offset":9569},"indent":[]}}],"position":{"start":{"line":406,"column":1,"offset":9545},"end":{"line":406,"column":25,"offset":9569},"indent":[]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">sudo</span> systemctl restart prometheus</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>","position":{"start":{"line":409,"column":1,"offset":9572},"end":{"line":411,"column":4,"offset":9620},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"그 후 ","position":{"start":{"line":413,"column":1,"offset":9622},"end":{"line":413,"column":5,"offset":9626},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Prometheus UI</code>","position":{"start":{"line":413,"column":5,"offset":9626},"end":{"line":413,"column":20,"offset":9641},"indent":[]}},{"type":"text","value":"에서 다음을 쿼리해보자.","position":{"start":{"line":413,"column":20,"offset":9641},"end":{"line":413,"column":33,"offset":9654},"indent":[]}}],"position":{"start":{"line":413,"column":1,"offset":9622},"end":{"line":413,"column":33,"offset":9654},"indent":[]}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">nginx_up</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>","position":{"start":{"line":415,"column":1,"offset":9656},"end":{"line":417,"column":4,"offset":9677},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"다음과 같이 나오면 성공이다.","position":{"start":{"line":419,"column":1,"offset":9679},"end":{"line":419,"column":17,"offset":9695},"indent":[]}}],"position":{"start":{"line":419,"column":1,"offset":9679},"end":{"line":419,"column":17,"offset":9695},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"https://user-images.githubusercontent.com/55419159/146771916-cd54be72-5e84-4f35-b5ec-233c47e827c2.png","alt":"image","position":{"start":{"line":421,"column":1,"offset":9697},"end":{"line":421,"column":112,"offset":9808},"indent":[]}}],"position":{"start":{"line":421,"column":1,"offset":9697},"end":{"line":421,"column":112,"offset":9808},"indent":[]}},{"type":"thematicBreak","position":{"start":{"line":423,"column":1,"offset":9810},"end":{"line":423,"column":4,"offset":9813},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#-grafana-대시보드-구축","title":null,"children":[],"data":{"hProperties":{"aria-label":" grafana 대시보드 구축 permalink","class":"anchor-header before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"📯 Grafana 대시보드 구축","position":{"start":{"line":425,"column":4,"offset":9818},"end":{"line":425,"column":22,"offset":9836},"indent":[]}}],"position":{"start":{"line":425,"column":1,"offset":9815},"end":{"line":425,"column":22,"offset":9836},"indent":[]},"data":{"id":"-grafana-대시보드-구축","htmlAttributes":{"id":"-grafana-대시보드-구축"},"hProperties":{"id":"-grafana-대시보드-구축","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"이제 대시보드를 구축한다. 다음 JSON 파일을 복사해서 대시보드를 임포트한다. (로컬 환경에는 이미 대시보드가 로드되어 있다.) \n","position":{"start":{"line":427,"column":1,"offset":9838},"end":{"line":428,"column":1,"offset":9912},"indent":[1]}},{"type":"link","title":null,"url":"https://grafana.com/grafana/dashboards/9614","children":[{"type":"text","value":"다음 링크","position":{"start":{"line":428,"column":2,"offset":9913},"end":{"line":428,"column":7,"offset":9918},"indent":[]}}],"position":{"start":{"line":428,"column":1,"offset":9912},"end":{"line":428,"column":53,"offset":9964},"indent":[]}},{"type":"text","value":"로 가서 JSON 파일을 복사한다.","position":{"start":{"line":428,"column":53,"offset":9964},"end":{"line":428,"column":72,"offset":9983},"indent":[]}}],"position":{"start":{"line":427,"column":1,"offset":9838},"end":{"line":428,"column":72,"offset":9983},"indent":[1]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"https://user-images.githubusercontent.com/55419159/146773163-8fd10949-e114-4128-8cb4-79d4eb8689df.png","alt":"image","position":{"start":{"line":430,"column":1,"offset":9985},"end":{"line":430,"column":112,"offset":10096},"indent":[]}}],"position":{"start":{"line":430,"column":1,"offset":9985},"end":{"line":430,"column":112,"offset":10096},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"다음과 같은 지표를 확인할 수 있다.","position":{"start":{"line":432,"column":1,"offset":10098},"end":{"line":432,"column":21,"offset":10118},"indent":[]}}],"position":{"start":{"line":432,"column":1,"offset":10098},"end":{"line":432,"column":21,"offset":10118},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">Nginx</code>","position":{"start":{"line":434,"column":3,"offset":10122},"end":{"line":434,"column":10,"offset":10129},"indent":[]}},{"type":"text","value":" 구동 상태","position":{"start":{"line":434,"column":10,"offset":10129},"end":{"line":434,"column":16,"offset":10135},"indent":[]}}],"position":{"start":{"line":434,"column":3,"offset":10122},"end":{"line":434,"column":16,"offset":10135},"indent":[]}}],"position":{"start":{"line":434,"column":1,"offset":10120},"end":{"line":434,"column":16,"offset":10135},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">Nginx Connection</code>","position":{"start":{"line":435,"column":3,"offset":10138},"end":{"line":435,"column":21,"offset":10156},"indent":[]}},{"type":"text","value":" 상태","position":{"start":{"line":435,"column":21,"offset":10156},"end":{"line":435,"column":24,"offset":10159},"indent":[]}}],"position":{"start":{"line":435,"column":3,"offset":10138},"end":{"line":435,"column":24,"offset":10159},"indent":[]}}],"position":{"start":{"line":435,"column":1,"offset":10136},"end":{"line":435,"column":24,"offset":10159},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">Nginx Connection</code>","position":{"start":{"line":436,"column":3,"offset":10162},"end":{"line":436,"column":21,"offset":10180},"indent":[]}},{"type":"text","value":" 개수","position":{"start":{"line":436,"column":21,"offset":10180},"end":{"line":436,"column":24,"offset":10183},"indent":[]}}],"position":{"start":{"line":436,"column":3,"offset":10162},"end":{"line":436,"column":24,"offset":10183},"indent":[]}}],"position":{"start":{"line":436,"column":1,"offset":10160},"end":{"line":436,"column":24,"offset":10183},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">Nginx</code>","position":{"start":{"line":437,"column":3,"offset":10186},"end":{"line":437,"column":10,"offset":10193},"indent":[]}},{"type":"text","value":" 초당 요청 개수","position":{"start":{"line":437,"column":10,"offset":10193},"end":{"line":437,"column":19,"offset":10202},"indent":[]}}],"position":{"start":{"line":437,"column":3,"offset":10186},"end":{"line":437,"column":19,"offset":10202},"indent":[]}}],"position":{"start":{"line":437,"column":1,"offset":10184},"end":{"line":437,"column":19,"offset":10202},"indent":[]}}],"position":{"start":{"line":434,"column":1,"offset":10120},"end":{"line":437,"column":19,"offset":10202},"indent":[1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":437,"column":19,"offset":10202}}}}