{"expireTime":9007200939154746000,"key":"transformer-remark-markdown-html-8da14a5ab776f0c24a7b14c9a2327bc5-gatsby-remark-code-titlesgatsby-remark-embed-youtubegatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-custom-blocksgatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":"<p>데이터베이스의 PK 세팅 전략을 세우려 한다.</p>\n<blockquote>\n<p><del>그냥 DB에서 <code class=\"language-text\">auto_increment</code> 하면 되지 않나?</del>\n➡️ 분산되어있는 환경이기 때문에 불가능하다.</p>\n</blockquote>\n<p><strong>분산 DB 환경</strong>에선 생각보다 쉽지 않다.\n방법을 찾아보자.</p>\n<h2 id=\"1단계--문제이해-및-설계범위-확정\" style=\"position:relative;\"><a href=\"#1%EB%8B%A8%EA%B3%84--%EB%AC%B8%EC%A0%9C%EC%9D%B4%ED%95%B4-%EB%B0%8F-%EC%84%A4%EA%B3%84%EB%B2%94%EC%9C%84-%ED%99%95%EC%A0%95\" aria-label=\"1단계  문제이해 및 설계범위 확정 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1단계 : 문제이해 및 설계범위 확정</h2>\n<blockquote>\n<p><em>시스템 설계 면접의 첫 단계는 적절한 질문을 통해 모호함을 없애고 설계 방향을 정하는 것이다.</em></p>\n</blockquote>\n<h3 id=\"지원자-vs-면접관-질문-예시\" style=\"position:relative;\"><a href=\"#%EC%A7%80%EC%9B%90%EC%9E%90-vs-%EB%A9%B4%EC%A0%91%EA%B4%80-%EC%A7%88%EB%AC%B8-%EC%98%88%EC%8B%9C\" aria-label=\"지원자 vs 면접관 질문 예시 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>지원자 vs 면접관 질문 예시</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">지원자 : ID는 어떤 특성을 갖나요?\n면접관 : 유일해야 하고, 정렬 가능해야합니다\n지원자 : 새로운 레코드에 붙일 ID는 항상 1만큼 큰 값이여야 하나요?\n면접관 : ID의 값은 시간이 흐름에 따라 커지지만, 언제나 1씩 증가한다고는 할 수 없습니다.\n지원자 : ID는 숫자로만 구성되나요?\n면접관 : 그렇습니다.\n지원자 : 시스템의 규모는 어느정도인가요?\n면접관 : 초당 10,000 ID를 생성할 수 있어야 합니다.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"질문을-통해-유추할-수-있는-요구사항은-다음과-같다\" style=\"position:relative;\"><a href=\"#%EC%A7%88%EB%AC%B8%EC%9D%84-%ED%86%B5%ED%95%B4-%EC%9C%A0%EC%B6%94%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8A%94-%EC%9A%94%EA%B5%AC%EC%82%AC%ED%95%AD%EC%9D%80-%EB%8B%A4%EC%9D%8C%EA%B3%BC-%EA%B0%99%EB%8B%A4\" aria-label=\"질문을 통해 유추할 수 있는 요구사항은 다음과 같다 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>질문을 통해 유추할 수 있는 요구사항은 다음과 같다.</h3>\n<ol>\n<li>ID는 <strong>유일</strong>해야 함</li>\n<li>ID는 <strong>숫자</strong>로만 구성되어야 함</li>\n<li>ID는 <strong>64비트</strong>로 표현될 수 있는 값이어야 함</li>\n<li>ID는 발급날짜에 따라 <strong>정렬가능</strong>해야 함</li>\n<li>초당 <strong>10,000</strong> ID 를 생성할 수 있어야 함</li>\n</ol>\n<hr>\n<h2 id=\"2단계--개략적-설계안-제시-및-동의-구하기\" style=\"position:relative;\"><a href=\"#2%EB%8B%A8%EA%B3%84--%EA%B0%9C%EB%9E%B5%EC%A0%81-%EC%84%A4%EA%B3%84%EC%95%88-%EC%A0%9C%EC%8B%9C-%EB%B0%8F-%EB%8F%99%EC%9D%98-%EA%B5%AC%ED%95%98%EA%B8%B0\" aria-label=\"2단계  개략적 설계안 제시 및 동의 구하기 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2단계 : 개략적 설계안 제시 및 동의 구하기</h2>\n<p>분산 시스템 상에서 ID 생성 전략을 알아보고 각각의 <strong>장단점</strong>과 위의 질문에 대해 <strong>적합한 전략</strong>인지 살펴보자.</p>\n<h3 id=\"다중-마스터-복제\" style=\"position:relative;\"><a href=\"#%EB%8B%A4%EC%A4%91-%EB%A7%88%EC%8A%A4%ED%84%B0-%EB%B3%B5%EC%A0%9C\" aria-label=\"다중 마스터 복제 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>다중 마스터 복제</h3>\n<p><img src=\"https://user-images.githubusercontent.com/55419159/141991101-f0657fa7-61da-4a9f-a90f-96a0b9223c44.png\" alt=\"image\"></p>\n<p>이 접근법은 기본적으로 DB의 <code class=\"language-text\">auto_increment</code> 속성을 활용한다.\n1만큼 증가시키는 것이 아닌 <code class=\"language-text\">k</code>(DB의 숫자)만큼 증가시킨다.</p>\n<h4 id=\"단점\" style=\"position:relative;\"><a href=\"#%EB%8B%A8%EC%A0%90\" aria-label=\"단점 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>단점</h4>\n<ul>\n<li>규모를 확장하거나 축소할 때 문제가 있음</li>\n</ul>\n<h3 id=\"uuid\" style=\"position:relative;\"><a href=\"#uuid\" aria-label=\"uuid permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>UUID</h3>\n<p><img src=\"https://user-images.githubusercontent.com/55419159/141992063-ab125f8f-f171-4b29-9e82-1786ba96c29b.png\" alt=\"image\"></p>\n<p>UUID는 컴퓨터 시스템에 저장되는 정보를 유일하게 식별하기 위한 <strong>128비트 짜리 숫자</strong>이다.\nUUID는 <strong>충돌 가능성</strong>이 지극히 낮다.(중복 UUID가 생길 확률은 초당 10억개의 UUID를 100년동안 만들어야 생김)</p>\n<h4 id=\"장점\" style=\"position:relative;\"><a href=\"#%EC%9E%A5%EC%A0%90\" aria-label=\"장점 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>장점</h4>\n<ul>\n<li>단순함</li>\n<li>서버 간 조율이 필요하지 않으므로 동기화 이슈 없음</li>\n<li>규모 확장 간편함</li>\n</ul>\n<h4 id=\"단점-1\" style=\"position:relative;\"><a href=\"#%EB%8B%A8%EC%A0%90-1\" aria-label=\"단점 1 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>단점</h4>\n<ul>\n<li>128비트로 길다</li>\n<li>시간 순으로 정렬할 수 없음</li>\n<li>ID에 숫자가 아닌 값이 포함됨</li>\n</ul>\n<h3 id=\"티켓-서버\" style=\"position:relative;\"><a href=\"#%ED%8B%B0%EC%BC%93-%EC%84%9C%EB%B2%84\" aria-label=\"티켓 서버 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>티켓 서버</h3>\n<p><img src=\"https://user-images.githubusercontent.com/55419159/141993088-4e1ddc61-a711-4e93-8199-43f4e8c1fe23.png\" alt=\"image\"></p>\n<p>티켓 서버는 auto_increment 기능을 하는 중앙 서버에서 유일키를 생성해 내려주는 방식이다.</p>\n<h4 id=\"장점-1\" style=\"position:relative;\"><a href=\"#%EC%9E%A5%EC%A0%90-1\" aria-label=\"장점 1 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>장점</h4>\n<ul>\n<li>유일성이 보장되는 숫자로만 구성된 ID를 쉽게 만들 수 있음</li>\n<li>구현이 쉽고 중소 규모의 어플리케이션에 적합</li>\n</ul>\n<h4 id=\"단점-2\" style=\"position:relative;\"><a href=\"#%EB%8B%A8%EC%A0%90-2\" aria-label=\"단점 2 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>단점</h4>\n<ul>\n<li>티켓서버가 SPOF(Single-Point-of_Failure)가 된다는 엄청난 단점</li>\n</ul>\n<h3 id=\"트위터-스노플레이크-접근법\" style=\"position:relative;\"><a href=\"#%ED%8A%B8%EC%9C%84%ED%84%B0-%EC%8A%A4%EB%85%B8%ED%94%8C%EB%A0%88%EC%9D%B4%ED%81%AC-%EC%A0%91%EA%B7%BC%EB%B2%95\" aria-label=\"트위터 스노플레이크 접근법 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>트위터 스노플레이크 접근법</h3>\n<p><img src=\"https://user-images.githubusercontent.com/55419159/141993807-cce535c1-5ff1-4a71-816a-932cd7f5aa89.png\" alt=\"image\"></p>\n<br>\n<p>이 전략은 기본적으로 <strong>ID를 여러 절로 분할</strong>한다.</p>\n<table>\n<thead>\n<tr>\n<th>섹션</th>\n<th>설명</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>사인 비트</td>\n<td>1비트를 할당한다. 쓰임세가 없지만 음양수를 구별할 때 사용할 수 있다.</td>\n</tr>\n<tr>\n<td>타임스탬프</td>\n<td>41비트를 할당한다. 기원시각으로부터 몇 밀리초가 지났는 지 알 수 있는 값이다.</td>\n</tr>\n<tr>\n<td>Work ID</td>\n<td>10비트를 할당한다.</td>\n</tr>\n<tr>\n<td>일련번호</td>\n<td>12비트를 할당한다. 각 서버에서는 ID를 생성할 때마다 1씩 증가시킨다. 1밀리초가 경과했을 때 0으로 초기화한다.</td>\n</tr>\n</tbody>\n</table>"}